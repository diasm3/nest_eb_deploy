<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>Elastic Beanstalk &#xc644;&#xc804; &#xc2e0;&#xaddc; &#xc124;&#xc815; &#xb9e4;&#xb274;&#xc5bc;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <h1 id="elastic-beanstalk-ì™„ì „-ì‹ ê·œ-ì„¤ì •-ë§¤ë‰´ì–¼">Elastic Beanstalk ì™„ì „ ì‹ ê·œ ì„¤ì • ë§¤ë‰´ì–¼</h1>
<p><em>ìƒˆë¡œìš´ AWS ê³„ì •ì—ì„œ NestJS Docker í”„ë¡œì íŠ¸ë¥¼ Elastic Beanstalkìœ¼ë¡œ ë°°í¬í•˜ëŠ” ì™„ë²½ ê°€ì´ë“œ</em></p>
<hr>
<h1 id="elastic-beanstalk-https-ì„¤ì •-ê°€ì´ë“œ">Elastic Beanstalk HTTPS ì„¤ì • ê°€ì´ë“œ</h1>
<h2 id="ï¸-ì „ì²´-í”Œë¡œìš°ì°¨íŠ¸">ğŸ—ºï¸ ì „ì²´ í”Œë¡œìš°ì°¨íŠ¸</h2>
<p><img src="file:////Users/semyungpark/Documents/project/aws_deploy_eb/aws_backend/flow-chart.svg" alt="Elastic Beanstalk HTTPS ì„¤ì • í”Œë¡œìš°ì°¨íŠ¸"></p>
<h2 id="-ì„¤ì •-ì™„ë£Œ-í›„-ê²°ê³¼">ğŸ¯ ì„¤ì • ì™„ë£Œ í›„ ê²°ê³¼</h2>
<ul>
<li>âœ… NestJS + Docker ì• í”Œë¦¬ì¼€ì´ì…˜</li>
<li>âœ… Elastic Beanstalk ìë™ ë°°í¬</li>
<li>âœ… GitHub Actions CI/CD</li>
<li>âœ… HTTPS ì§€ì› (ALB ê¸°ë³¸ í¬í•¨)</li>
<li>âœ… ë„ë©”ì¸ ì—°ê²° (ì„ íƒì‚¬í•­)</li>
</ul>
<hr>
<h2 id="-ì‚¬ì „-ì¤€ë¹„ì‚¬í•­">ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­</h2>
<h3 id="í•„ìš”í•œ-ì •ë³´">í•„ìš”í•œ ì •ë³´</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>AWS ê³„ì •</strong> (ê´€ë¦¬ì ê¶Œí•œ)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>GitHub ê³„ì •</strong> ë° ì €ì¥ì†Œ</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>ë„ë©”ì¸</strong> (ì„ íƒì‚¬í•­)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>ê°œë°œ í™˜ê²½</strong> (Node.js, Docker, Git)</li>
</ul>
<h3 id="ì†Œí”„íŠ¸ì›¨ì–´-ì„¤ì¹˜">ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ì¹˜</h3>
<pre><code class="language-bash"><span class="hljs-comment"># 1. Node.js ì„¤ì¹˜ í™•ì¸</span>
node --version  <span class="hljs-comment"># v18 ì´ìƒ</span>

<span class="hljs-comment"># 2. Docker ì„¤ì¹˜ í™•ì¸</span>
docker --version

<span class="hljs-comment"># 3. Git ì„¤ì¹˜ í™•ì¸</span>
git --version

<span class="hljs-comment"># 4. AWS CLI ì„¤ì¹˜</span>
<span class="hljs-comment"># macOS: brew install awscli</span>
<span class="hljs-comment"># Windows: https://aws.amazon.com/cli/</span>
aws --version

<span class="hljs-comment"># 5. EB CLI ì„¤ì¹˜</span>
pip install awsebcli
eb --version
</code></pre>
<hr>
<h2 id="-1ë‹¨ê³„-aws-ê³„ì •-ì„¤ì •">ğŸ”§ 1ë‹¨ê³„: AWS ê³„ì • ì„¤ì •</h2>
<h3 id="11-iam-ì‚¬ìš©ì-ìƒì„±">1.1 IAM ì‚¬ìš©ì ìƒì„±</h3>
<p><strong>AWS Console â†’ IAM â†’ ì‚¬ìš©ì</strong></p>
<pre><code class="language-yaml"><span class="hljs-string">ì‚¬ìš©ì</span> <span class="hljs-string">ì´ë¦„:</span> <span class="hljs-string">eb-deploy-user</span>
<span class="hljs-string">ì•¡ì„¸ìŠ¤</span> <span class="hljs-string">ìœ í˜•:</span> <span class="hljs-string">âœ…</span> <span class="hljs-string">ì•¡ì„¸ìŠ¤</span> <span class="hljs-string">í‚¤</span> <span class="hljs-bullet">-</span> <span class="hljs-string">í”„ë¡œê·¸ë˜ë§¤í‹±</span> <span class="hljs-string">ì•¡ì„¸ìŠ¤</span>

<span class="hljs-string">ê¶Œí•œ</span> <span class="hljs-string">ì •ì±…</span> <span class="hljs-string">(í•„ìˆ˜):</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">AWSElasticBeanstalkFullAccess</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">IAMFullAccess</span> <span class="hljs-string">(ì¤‘ìš”!</span> <span class="hljs-string">ì„œë¹„ìŠ¤</span> <span class="hljs-string">ë¡¤</span> <span class="hljs-string">ìƒì„±ìš©)</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">AmazonS3FullAccess</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">AmazonEC2FullAccess</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">ElasticLoadBalancingFullAccess</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">AutoScalingFullAccess</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">AWSCertificateManagerFullAccess</span> <span class="hljs-string">(HTTPSìš©)</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">CloudWatchFullAccess</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">CloudFormationFullAccess</span>
</code></pre>
<p><strong>âš ï¸ ì¤‘ìš”:</strong> <code>IAMFullAccess</code> ì •ì±…ì´ ì—†ìœ¼ë©´ Elastic Beanstalkê°€ í•„ìš”í•œ ì„œë¹„ìŠ¤ ë¡¤ì„ ìƒì„±í•  ìˆ˜ ì—†ì–´ ë°°í¬ê°€ ì‹¤íŒ¨í•©ë‹ˆë‹¤.</p>
<h3 id="12-aws-ìê²©ì¦ëª…-ì„¤ì •">1.2 AWS ìê²©ì¦ëª… ì„¤ì •</h3>
<pre><code class="language-bash"><span class="hljs-comment"># AWS CLI ì„¤ì •</span>
aws configure

<span class="hljs-comment"># ì…ë ¥í•  ì •ë³´:</span>
AWS Access Key ID: AKIA..................
AWS Secret Access Key: ......................
Default region name: ap-northeast-2
Default output format: json

<span class="hljs-comment"># ì„¤ì • í™•ì¸</span>
aws sts get-caller-identity
</code></pre>
<h3 id="13-í•„ìˆ˜-ì„œë¹„ìŠ¤-ë¡¤-ìƒì„±-ì„ íƒì‚¬í•­">1.3 í•„ìˆ˜ ì„œë¹„ìŠ¤ ë¡¤ ìƒì„± (ì„ íƒì‚¬í•­)</h3>
<p>IAM ê¶Œí•œì´ ì¶©ë¶„í•˜ë‹¤ë©´ Elastic Beanstalkê°€ ìë™ìœ¼ë¡œ ìƒì„±í•˜ì§€ë§Œ, ìˆ˜ë™ìœ¼ë¡œ ë¯¸ë¦¬ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:</p>
<pre><code class="language-bash"><span class="hljs-comment"># EC2 ì¸ìŠ¤í„´ìŠ¤ ë¡¤ ìƒì„±</span>
aws iam create-role \
    --role-name aws-elasticbeanstalk-ec2-role \
    --assume-role-policy-document <span class="hljs-string">&#x27;{
        &quot;Version&quot;: &quot;2012-10-17&quot;,
        &quot;Statement&quot;: [
            {
                &quot;Effect&quot;: &quot;Allow&quot;,
                &quot;Principal&quot;: {&quot;Service&quot;: &quot;ec2.amazonaws.com&quot;},
                &quot;Action&quot;: &quot;sts:AssumeRole&quot;
            }
        ]
    }&#x27;</span>

<span class="hljs-comment"># ì •ì±… ì—°ê²°</span>
aws iam attach-role-policy \
    --role-name aws-elasticbeanstalk-ec2-role \
    --policy-arn arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier

aws iam attach-role-policy \
    --role-name aws-elasticbeanstalk-ec2-role \
    --policy-arn arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier

<span class="hljs-comment"># ì¸ìŠ¤í„´ìŠ¤ í”„ë¡œíŒŒì¼ ìƒì„±</span>
aws iam create-instance-profile \
    --instance-profile-name aws-elasticbeanstalk-ec2-role

aws iam add-role-to-instance-profile \
    --instance-profile-name aws-elasticbeanstalk-ec2-role \
    --role-name aws-elasticbeanstalk-ec2-role

<span class="hljs-comment"># ì„œë¹„ìŠ¤ ë¡¤ ìƒì„±</span>
aws iam create-role \
    --role-name aws-elasticbeanstalk-service-role \
    --assume-role-policy-document <span class="hljs-string">&#x27;{
        &quot;Version&quot;: &quot;2012-10-17&quot;,
        &quot;Statement&quot;: [
            {
                &quot;Effect&quot;: &quot;Allow&quot;,
                &quot;Principal&quot;: {&quot;Service&quot;: &quot;elasticbeanstalk.amazonaws.com&quot;},
                &quot;Action&quot;: &quot;sts:AssumeRole&quot;
            }
        ]
    }&#x27;</span>

aws iam attach-role-policy \
    --role-name aws-elasticbeanstalk-service-role \
    --policy-arn arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkService
</code></pre>
<hr>
<h2 id="-2ë‹¨ê³„-nestjs-í”„ë¡œì íŠ¸-ì„¤ì •">ğŸ“¦ 2ë‹¨ê³„: NestJS í”„ë¡œì íŠ¸ ì„¤ì •</h2>
<h3 id="21-í”„ë¡œì íŠ¸-ìƒì„±">2.1 í”„ë¡œì íŠ¸ ìƒì„±</h3>
<pre><code class="language-bash"><span class="hljs-comment"># ìƒˆ NestJS í”„ë¡œì íŠ¸ ìƒì„±</span>
npx @nestjs/cli new my-app
<span class="hljs-built_in">cd</span> my-app

<span class="hljs-comment"># ë˜ëŠ” ê¸°ì¡´ í”„ë¡œì íŠ¸ í´ë¡ </span>
git <span class="hljs-built_in">clone</span> https://github.com/username/my-nestjs-app
<span class="hljs-built_in">cd</span> my-nestjs-app
</code></pre>
<h3 id="22-í”„ë¡œì íŠ¸-êµ¬ì¡°-ì„¤ì •">2.2 í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ì •</h3>
<p><strong>ë””ë ‰í† ë¦¬ êµ¬ì¡°:</strong></p>
<pre><code>my-app/
â”œâ”€â”€ .github/workflows/          # GitHub Actions
â”œâ”€â”€ .ebextensions/             # EB ì„¤ì •
â”œâ”€â”€ src/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ package.json
â””â”€â”€ README.md
</code></pre>
<h3 id="23-í•µì‹¬-íŒŒì¼-ìƒì„±">2.3 í•µì‹¬ íŒŒì¼ ìƒì„±</h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile"><span class="hljs-comment"># Multi-stage build ì‚¬ìš©</span>
<span class="hljs-keyword">FROM</span> node:<span class="hljs-number">18</span>-alpine AS builder

<span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span>

<span class="hljs-comment"># íŒ¨í‚¤ì§€ íŒŒì¼ë“¤ë§Œ ë¨¼ì € ë³µì‚¬ (ìºì‹œ íš¨ìœ¨ì„±)</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> package.json yarn.lock ./</span>

<span class="hljs-comment"># ë¹Œë“œ ì˜ì¡´ì„±ë§Œ ì„¤ì¹˜</span>
<span class="hljs-keyword">RUN</span><span class="language-bash"> yarn install --frozen-lockfile --production=<span class="hljs-literal">false</span></span>

<span class="hljs-comment"># ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span>

<span class="hljs-comment"># ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ</span>
<span class="hljs-keyword">RUN</span><span class="language-bash"> yarn build</span>

<span class="hljs-comment"># Production ì˜ì¡´ì„±ë§Œ ì„¤ì¹˜</span>
<span class="hljs-keyword">RUN</span><span class="language-bash"> yarn install --frozen-lockfile --production=<span class="hljs-literal">true</span> &amp;&amp; yarn cache clean</span>

<span class="hljs-comment"># Production ë‹¨ê³„</span>
<span class="hljs-keyword">FROM</span> node:<span class="hljs-number">18</span>-alpine AS production

<span class="hljs-comment"># ë³´ì•ˆì„ ìœ„í•œ non-root ìœ ì € ìƒì„±</span>
<span class="hljs-keyword">RUN</span><span class="language-bash"> addgroup -g 1001 -S nodejs &amp;&amp; \
    adduser -S nestjs -u 1001</span>

<span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span>

<span class="hljs-comment"># ë¹Œë“œëœ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ production ì˜ì¡´ì„±ë§Œ ë³µì‚¬</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> --from=builder --<span class="hljs-built_in">chown</span>=nestjs:nodejs /app/dist ./dist</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> --from=builder --<span class="hljs-built_in">chown</span>=nestjs:nodejs /app/node_modules ./node_modules</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> --from=builder --<span class="hljs-built_in">chown</span>=nestjs:nodejs /app/package.json ./</span>

<span class="hljs-comment"># non-root ìœ ì €ë¡œ ì „í™˜</span>
<span class="hljs-keyword">USER</span> nestjs

<span class="hljs-comment"># í™˜ê²½ ë³€ìˆ˜ ì„¤ì •</span>
<span class="hljs-keyword">ENV</span> NODE_ENV=production
<span class="hljs-keyword">ENV</span> NODE_OPTIONS=<span class="hljs-string">&quot;--max-old-space-size=512&quot;</span>
<span class="hljs-keyword">ENV</span> PORT=<span class="hljs-number">8080</span>

<span class="hljs-comment"># í¬íŠ¸ ë…¸ì¶œ</span>
<span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span>

<span class="hljs-comment"># í—¬ìŠ¤ì²´í¬ ì¶”ê°€</span>
<span class="hljs-keyword">HEALTHCHECK</span><span class="language-bash"> --interval=30s --<span class="hljs-built_in">timeout</span>=3s --start-period=30s --retries=3 \
  CMD wget --no-verbose --tries=1 --spider http://localhost:8080/ || <span class="hljs-built_in">exit</span> 1</span>

<span class="hljs-comment"># ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘</span>
<span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;node&quot;</span>, <span class="hljs-string">&quot;dist/main&quot;</span>]</span>
</code></pre>
<p><strong>.dockerignore:</strong></p>
<pre><code class="language-dockerignore">node_modules
npm-debug.log
yarn-error.log
.git
.gitignore
README.md
.env
.nyc_output
coverage
.cache
.vscode
.idea
dist
*.log
.DS_Store
Thumbs.db
.ebextensions
.elasticbeanstalk
.github
</code></pre>
<p><strong>src/main.ts (ì¤‘ìš”!):</strong></p>
<pre><code class="language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NestFactory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/core&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./app.module&#x27;</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NestFactory</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">AppModule</span>);

  <span class="hljs-comment">// CORS ì„¤ì • (í•„ìš”ì‹œ)</span>
  app.<span class="hljs-title function_">enableCors</span>();

  <span class="hljs-comment">// í¬íŠ¸ ì„¤ì • (EBì—ì„œ í™˜ê²½ë³€ìˆ˜ë¡œ ì œê³µ)</span>
  <span class="hljs-keyword">const</span> port = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">8080</span>;

  <span class="hljs-comment">// 0.0.0.0ìœ¼ë¡œ ë°”ì¸ë”© (ì¤‘ìš”!)</span>
  <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">listen</span>(port, <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸš€ Application is running on: http://0.0.0.0:<span class="hljs-subst">${port}</span>`</span>);
}
<span class="hljs-title function_">bootstrap</span>();
</code></pre>
<p><strong>src/app.controller.ts (í—¬ìŠ¤ì²´í¬):</strong></p>
<pre><code class="language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Controller</span>, <span class="hljs-title class_">Get</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/common&#x27;</span>;

<span class="hljs-meta">@Controller</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppController</span> {
  <span class="hljs-meta">@Get</span>()
  <span class="hljs-title function_">getRoot</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;NestJS App is running!&#x27;</span>;
  }

  <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;health&#x27;</span>)
  <span class="hljs-title function_">healthCheck</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;ok&#x27;</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
      <span class="hljs-attr">uptime</span>: process.<span class="hljs-title function_">uptime</span>(),
      <span class="hljs-attr">environment</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> || <span class="hljs-string">&#x27;development&#x27;</span>,
    };
  }
}
</code></pre>
<hr>
<h2 id="ï¸-3ë‹¨ê³„-elastic-beanstalk-ì„¤ì •">âš™ï¸ 3ë‹¨ê³„: Elastic Beanstalk ì„¤ì •</h2>
<h3 id="31-ebextensions-í´ë”-ìƒì„±">3.1 .ebextensions í´ë” ìƒì„±</h3>
<pre><code class="language-bash"><span class="hljs-built_in">mkdir</span> .ebextensions
</code></pre>
<p><strong>.ebextensions/01-environment.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:autoscaling:launchconfiguration:</span>
    <span class="hljs-attr">InstanceType:</span> <span class="hljs-string">t3.small</span>
    <span class="hljs-attr">IamInstanceProfile:</span> <span class="hljs-string">aws-elasticbeanstalk-ec2-role</span>
  <span class="hljs-attr">aws:elasticbeanstalk:environment:</span>
    <span class="hljs-attr">EnvironmentType:</span> <span class="hljs-string">LoadBalanced</span>
    <span class="hljs-attr">LoadBalancerType:</span> <span class="hljs-string">application</span>
    <span class="hljs-attr">ServiceRole:</span> <span class="hljs-string">aws-elasticbeanstalk-service-role</span>
  <span class="hljs-attr">aws:autoscaling:asg:</span>
    <span class="hljs-attr">MinSize:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">MaxSize:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">aws:autoscaling:updatepolicy:rollingupdate:</span>
    <span class="hljs-attr">RollingUpdateEnabled:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">MinInstancesInService:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">MaxBatchSize:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">RollingUpdateType:</span> <span class="hljs-string">Health</span>
  <span class="hljs-attr">aws:elasticbeanstalk:application:environment:</span>
    <span class="hljs-attr">NODE_ENV:</span> <span class="hljs-string">production</span>
    <span class="hljs-attr">PORT:</span> <span class="hljs-number">8080</span>
</code></pre>
<p><strong>.ebextensions/02-health.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:elasticbeanstalk:environment:process:default:</span>
    <span class="hljs-attr">Port:</span> <span class="hljs-number">8080</span>
    <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTP</span>
    <span class="hljs-attr">HealthCheckPath:</span> <span class="hljs-string">/health</span>
    <span class="hljs-attr">HealthCheckIntervalSeconds:</span> <span class="hljs-number">15</span>
    <span class="hljs-attr">HealthyThresholdCount:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">UnhealthyThresholdCount:</span> <span class="hljs-number">5</span>
    <span class="hljs-attr">HealthCheckTimeoutSeconds:</span> <span class="hljs-number">5</span>
  <span class="hljs-attr">aws:elasticbeanstalk:healthreporting:system:</span>
    <span class="hljs-attr">SystemType:</span> <span class="hljs-string">enhanced</span>
</code></pre>
<p><strong>.ebextensions/03-logging.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-attr">files:</span>
  <span class="hljs-string">&#x27;/opt/elasticbeanstalk/tasks/taillogs.d/01-app.conf&#x27;</span><span class="hljs-string">:</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-string">&#x27;000644&#x27;</span>
    <span class="hljs-attr">owner:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">group:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">content:</span> <span class="hljs-string">|
      /var/log/eb-docker/containers/eb-current-app/eb-*-stdouterr.log
</span>
<span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:elasticbeanstalk:cloudwatch:logs:</span>
    <span class="hljs-attr">StreamLogs:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">DeleteOnTerminate:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">RetentionInDays:</span> <span class="hljs-number">7</span>
</code></pre>
<h3 id="32-eb-ì´ˆê¸°í™”">3.2 EB ì´ˆê¸°í™”</h3>
<pre><code class="language-bash"><span class="hljs-comment"># EB ì´ˆê¸°í™”</span>
eb init

<span class="hljs-comment"># ì„¤ì • ì…ë ¥:</span>
<span class="hljs-comment"># 1. ë¦¬ì „ ì„ íƒ: ap-northeast-2 (ì„œìš¸)</span>
<span class="hljs-comment"># 2. ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„: my-app (ì›í•˜ëŠ” ì´ë¦„)</span>
<span class="hljs-comment"># 3. í”Œë«í¼: Docker</span>
<span class="hljs-comment"># 4. í”Œë«í¼ ë²„ì „: Docker running on 64bit Amazon Linux 2023 (ìµœì‹ )</span>
<span class="hljs-comment"># 5. CodeCommit: No</span>
<span class="hljs-comment"># 6. SSH: Yes (í‚¤í˜ì–´ ì´ë¦„ ì…ë ¥ ë˜ëŠ” ìƒˆë¡œ ìƒì„±)</span>
</code></pre>
<h3 id="33-í™˜ê²½-ìƒì„±">3.3 í™˜ê²½ ìƒì„±</h3>
<pre><code class="language-bash"><span class="hljs-comment"># í™˜ê²½ ìƒì„± (HTTPS ì§€ì›ì„ ìœ„í•œ ALB í¬í•¨)</span>
eb create production \
    --elb-type application \
    --instance_type t3.small \
    --min-instances 1 \
    --max-instances 3 \
    --envvars NODE_ENV=production,PORT=8080 \
    --service-role aws-elasticbeanstalk-service-role

<span class="hljs-comment"># ë˜ëŠ” ê¸°ë³¸ í™˜ê²½ ìƒì„± í›„ ì„¤ì •</span>
eb create production
</code></pre>
<p><strong>âš ï¸ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ í•´ê²°:</strong></p>
<p>ë§Œì•½ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´:</p>
<ul>
<li><code>&quot;option_settings&quot; in one of the configuration files failed validation</code></li>
<li><code>You can't enable rolling updates for a single-instance environment</code></li>
<li><code>Insufficient IAM privileges</code></li>
</ul>
<p><strong>í•´ê²°ë°©ë²•:</strong></p>
<ol>
<li>IAM ì‚¬ìš©ìì— <code>IAMFullAccess</code> ì •ì±…ì´ ìˆëŠ”ì§€ í™•ì¸</li>
<li>ìœ„ì˜ 1.3 ë‹¨ê³„ì˜ ì„œë¹„ìŠ¤ ë¡¤ ìƒì„± ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰</li>
<li>í™˜ê²½ì„ LoadBalanced íƒ€ì…ìœ¼ë¡œ ìƒì„± (Single Instance ëŒ€ì‹ )</li>
</ol>
<h3 id="34-ì²«-ë°°í¬">3.4 ì²« ë°°í¬</h3>
<pre><code class="language-bash"><span class="hljs-comment"># í™˜ê²½ ìƒì„± ì™„ë£Œ í™•ì¸</span>
eb status production
eb health production

<span class="hljs-comment"># ì²« ë°°í¬</span>
eb deploy production --<span class="hljs-built_in">timeout</span> 15

<span class="hljs-comment"># ë°°í¬ ì™„ë£Œ í›„ ìµœì¢… í™•ì¸</span>
eb status production
eb health production

<span class="hljs-comment"># ì• í”Œë¦¬ì¼€ì´ì…˜ ì—´ê¸°</span>
eb open production
</code></pre>
<hr>
<h2 id="-4ë‹¨ê³„-github-ë¸Œëœì¹˜-ì „ëµ-ë°-cicd-ì„¤ì •">ğŸš€ 4ë‹¨ê³„: GitHub ë¸Œëœì¹˜ ì „ëµ ë° CI/CD ì„¤ì •</h2>
<h3 id="41-ë¸Œëœì¹˜-ì „ëµ-ì„¤ì •">4.1 ë¸Œëœì¹˜ ì „ëµ ì„¤ì •</h3>
<p><strong>ë¸Œëœì¹˜ êµ¬ì¡°:</strong></p>
<pre><code>main (ë³´í˜¸ë¨, ì•„ì¹´ì´ë¸Œìš©)
â”œâ”€â”€ rel (ë¦´ë¦¬ì¦ˆ ë¸Œëœì¹˜) â†’ Production í™˜ê²½ (ìµœì¢… ë°°í¬)
â”œâ”€â”€ dev (ê°œë°œ ë¸Œëœì¹˜) â†’ Development í™˜ê²½
â””â”€â”€ feature/* (ê¸°ëŠ¥ ë¸Œëœì¹˜) â†’ ë¡œì»¬ ê°œë°œ
</code></pre>
<p><strong>ì›Œí¬í”Œë¡œìš°:</strong></p>
<pre><code>1. feature/new-feature â†’ dev (PR) â†’ Development ë°°í¬
2. dev â†’ rel (PR) â†’ Production ë°°í¬ (ìµœì¢…)
</code></pre>
<h3 id="42-ë¸Œëœì¹˜-ìƒì„±-ë°-ë³´í˜¸-ì„¤ì •">4.2 ë¸Œëœì¹˜ ìƒì„± ë° ë³´í˜¸ ì„¤ì •</h3>
<pre><code class="language-bash"><span class="hljs-comment"># ë¡œì»¬ì—ì„œ ë¸Œëœì¹˜ ìƒì„±</span>
git checkout -b dev
git push origin dev

git checkout -b rel
git push origin rel

<span class="hljs-comment"># main ë¸Œëœì¹˜ë¡œ ëŒì•„ê°€ê¸° (ì•„ì¹´ì´ë¸Œìš©)</span>
git checkout main
</code></pre>
<p><strong>GitHubì—ì„œ ë¸Œëœì¹˜ ë³´í˜¸ ì„¤ì •:</strong></p>
<pre><code>Repository â†’ Settings â†’ Branches â†’ Add rule

rel ë¸Œëœì¹˜ (ìµœì¢… ë°°í¬):
âœ… Require pull request reviews before merging
âœ… Require status checks to pass before merging
âœ… Require branches to be up to date before merging
âœ… Include administrators

dev ë¸Œëœì¹˜:
âœ… Require pull request reviews before merging (optional)
âœ… Require status checks to pass before merging (optional)

main ë¸Œëœì¹˜ (ì•„ì¹´ì´ë¸Œ):
âœ… Require pull request reviews before merging
âœ… Include administrators
</code></pre>
<h3 id="43-github-secrets-ì„¤ì •">4.3 GitHub Secrets ì„¤ì •</h3>
<p><strong>GitHub Repository â†’ Settings â†’ Secrets and variables â†’ Actions</strong></p>
<pre><code class="language-yaml"><span class="hljs-string">Secrets</span> <span class="hljs-string">ì¶”ê°€:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">AWS_ACCESS_KEY:</span> <span class="hljs-string">(IAM</span> <span class="hljs-string">ì‚¬ìš©ìì˜</span> <span class="hljs-string">Access</span> <span class="hljs-string">Key</span> <span class="hljs-string">ID)</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">AWS_ACCESS_SECRET_KEY:</span> <span class="hljs-string">(IAM</span> <span class="hljs-string">ì‚¬ìš©ìì˜</span> <span class="hljs-string">Secret</span> <span class="hljs-string">Access</span> <span class="hljs-string">Key)</span>

  <span class="hljs-comment"># í™˜ê²½ë³„ ì„¤ì • (ì„ íƒì‚¬í•­)</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">DEV_APP_NAME:</span> <span class="hljs-string">my-app</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">DEV_ENV_NAME:</span> <span class="hljs-string">development</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">PROD_APP_NAME:</span> <span class="hljs-string">my-app</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">PROD_ENV_NAME:</span> <span class="hljs-string">production</span>
</code></pre>
<h3 id="44-github-actions-ì›Œí¬í”Œë¡œìš°-íŒŒì¼-ìƒì„±">4.4 GitHub Actions ì›Œí¬í”Œë¡œìš° íŒŒì¼ ìƒì„±</h3>
<p><strong>.github/workflows/deploy-dev.yml</strong> (dev ë¸Œëœì¹˜ìš©):</p>
<pre><code class="language-yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Development</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">pull_request:</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">dev</span>
    <span class="hljs-attr">types:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">closed</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy-dev:</span>
    <span class="hljs-attr">if:</span> <span class="hljs-string">github.event.pull_request.merged</span> <span class="hljs-string">==</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Get</span> <span class="hljs-string">Timestamp</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">gerred/actions/current-time@master</span>
        <span class="hljs-attr">id:</span> <span class="hljs-string">current-time</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">String</span> <span class="hljs-string">Replace</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">frabert/replace-string-action@master</span>
        <span class="hljs-attr">id:</span> <span class="hljs-string">format-time</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">pattern:</span> <span class="hljs-string">&#x27;[:\.]+&#x27;</span>
          <span class="hljs-attr">string:</span> <span class="hljs-string">&#x27;$<span class="hljs-template-variable">{{ steps.current-time.outputs.time }}</span>&#x27;</span>
          <span class="hljs-attr">replace-with:</span> <span class="hljs-string">&#x27;-&#x27;</span>
          <span class="hljs-attr">flags:</span> <span class="hljs-string">&#x27;g&#x27;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">Deployment</span> <span class="hljs-string">Package</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">zip</span> <span class="hljs-string">-r</span> <span class="hljs-string">deploy.zip</span> <span class="hljs-string">.</span> <span class="hljs-string">-x</span> <span class="hljs-string">&quot;**node_modules**&quot;</span> <span class="hljs-string">&quot;**.git**&quot;</span> <span class="hljs-string">&quot;**.github**&quot;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Development</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">einaregilsson/beanstalk-deploy@v21</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">aws_access_key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_ACCESS_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">aws_secret_key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_ACCESS_SECRET_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">application_name:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.DEV_APP_NAME</span> <span class="hljs-string">||</span> <span class="hljs-string">&#x27;my-app&#x27;</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">environment_name:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.DEV_ENV_NAME</span> <span class="hljs-string">||</span> <span class="hljs-string">&#x27;development&#x27;</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">version_label:</span> <span class="hljs-string">&#x27;dev-$<span class="hljs-template-variable">{{ steps.format-time.outputs.replaced }}</span>&#x27;</span>
          <span class="hljs-attr">region:</span> <span class="hljs-string">ap-northeast-2</span>
          <span class="hljs-attr">deployment_package:</span> <span class="hljs-string">deploy.zip</span>
          <span class="hljs-attr">wait_for_environment_recovery:</span> <span class="hljs-number">300</span>
          <span class="hljs-attr">version_description:</span> <span class="hljs-string">&#x27;Dev: $<span class="hljs-template-variable">{{ github.event.pull_request.title }}</span>&#x27;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Comment</span> <span class="hljs-string">PR</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/github-script@v6</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">script:</span> <span class="hljs-string">|
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: &#x27;ğŸš€ Development í™˜ê²½ì— ë°°í¬ ì™„ë£Œ!\në°°í¬ ë²„ì „: dev-${{ steps.format-time.outputs.replaced }}&#x27;
            })
</span></code></pre>
<p><strong>.github/workflows/deploy-rel.yml</strong> (rel ë¸Œëœì¹˜ìš© - ìµœì¢… ë°°í¬):</p>
<pre><code class="language-yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Production</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">pull_request:</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">rel</span>
    <span class="hljs-attr">types:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">closed</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy-production:</span>
    <span class="hljs-attr">if:</span> <span class="hljs-string">github.event.pull_request.merged</span> <span class="hljs-string">==</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Get</span> <span class="hljs-string">Timestamp</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">gerred/actions/current-time@master</span>
        <span class="hljs-attr">id:</span> <span class="hljs-string">current-time</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">String</span> <span class="hljs-string">Replace</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">frabert/replace-string-action@master</span>
        <span class="hljs-attr">id:</span> <span class="hljs-string">format-time</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">pattern:</span> <span class="hljs-string">&#x27;[:\.]+&#x27;</span>
          <span class="hljs-attr">string:</span> <span class="hljs-string">&#x27;$<span class="hljs-template-variable">{{ steps.current-time.outputs.time }}</span>&#x27;</span>
          <span class="hljs-attr">replace-with:</span> <span class="hljs-string">&#x27;-&#x27;</span>
          <span class="hljs-attr">flags:</span> <span class="hljs-string">&#x27;g&#x27;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">Deployment</span> <span class="hljs-string">Package</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">zip</span> <span class="hljs-string">-r</span> <span class="hljs-string">deploy.zip</span> <span class="hljs-string">.</span> <span class="hljs-string">-x</span> <span class="hljs-string">&quot;**node_modules**&quot;</span> <span class="hljs-string">&quot;**.git**&quot;</span> <span class="hljs-string">&quot;**.github**&quot;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Production</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">einaregilsson/beanstalk-deploy@v21</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">aws_access_key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_ACCESS_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">aws_secret_key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_ACCESS_SECRET_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">application_name:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.PROD_APP_NAME</span> <span class="hljs-string">||</span> <span class="hljs-string">&#x27;my-app&#x27;</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">environment_name:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.PROD_ENV_NAME</span> <span class="hljs-string">||</span> <span class="hljs-string">&#x27;production&#x27;</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">version_label:</span> <span class="hljs-string">&#x27;prod-$<span class="hljs-template-variable">{{ steps.format-time.outputs.replaced }}</span>&#x27;</span>
          <span class="hljs-attr">region:</span> <span class="hljs-string">ap-northeast-2</span>
          <span class="hljs-attr">deployment_package:</span> <span class="hljs-string">deploy.zip</span>
          <span class="hljs-attr">wait_for_environment_recovery:</span> <span class="hljs-number">300</span>
          <span class="hljs-attr">version_description:</span> <span class="hljs-string">&#x27;Production: $<span class="hljs-template-variable">{{ github.event.pull_request.title }}</span>&#x27;</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Create</span> <span class="hljs-string">Release</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/create-release@v1</span>
        <span class="hljs-attr">env:</span>
          <span class="hljs-attr">GITHUB_TOKEN:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">}}</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">tag_name:</span> <span class="hljs-string">v${{</span> <span class="hljs-string">steps.format-time.outputs.replaced</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">release_name:</span> <span class="hljs-string">Release</span> <span class="hljs-string">v${{</span> <span class="hljs-string">steps.format-time.outputs.replaced</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">body:</span> <span class="hljs-string">|
            ğŸ‰ Production ë°°í¬ ì™„ë£Œ!
</span>
            <span class="hljs-string">**ë°°í¬</span> <span class="hljs-string">ë‚´ìš©:**</span> <span class="hljs-string">${{</span> <span class="hljs-string">github.event.pull_request.title</span> <span class="hljs-string">}}</span>
            <span class="hljs-string">**ë°°í¬</span> <span class="hljs-string">ë²„ì „:**</span> <span class="hljs-string">prod-${{</span> <span class="hljs-string">steps.format-time.outputs.replaced</span> <span class="hljs-string">}}</span>
            <span class="hljs-string">**ë°°í¬</span> <span class="hljs-string">ì‹œê°„:**</span> <span class="hljs-string">${{</span> <span class="hljs-string">steps.current-time.outputs.time</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">draft:</span> <span class="hljs-literal">false</span>
          <span class="hljs-attr">prerelease:</span> <span class="hljs-literal">false</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Notify</span> <span class="hljs-string">Team</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/github-script@v6</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">script:</span> <span class="hljs-string">|
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: &#x27;ğŸ‰ **Production ë°°í¬ ì™„ë£Œ!**\n\në°°í¬ ë²„ì „: prod-${{ steps.format-time.outputs.replaced }}\në¦´ë¦¬ì¦ˆ: v${{ steps.format-time.outputs.replaced }}\n\nëª¨ë“  íŒ€ì›ì—ê²Œ ë°°í¬ ì™„ë£Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”! ğŸš€&#x27;
            })
</span></code></pre>
<p><strong>.github/workflows/deploy-production.yml</strong> (main ë¸Œëœì¹˜ìš© - ì•„ì¹´ì´ë¸Œ):</p>
<pre><code class="language-yaml"><span class="hljs-comment"># ì´ ì›Œí¬í”Œë¡œìš°ëŠ” í•„ìš”ì‹œì—ë§Œ ì‚¬ìš© (ì•„ì¹´ì´ë¸Œ ëª©ì )</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Archive</span> <span class="hljs-string">to</span> <span class="hljs-string">Main</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">workflow_dispatch:</span> <span class="hljs-comment"># ìˆ˜ë™ ì‹¤í–‰ë§Œ í—ˆìš©</span>
    <span class="hljs-attr">inputs:</span>
      <span class="hljs-attr">reason:</span>
        <span class="hljs-attr">description:</span> <span class="hljs-string">&#x27;Archive reason&#x27;</span>
        <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">archive-to-main:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Create</span> <span class="hljs-string">Archive</span> <span class="hljs-string">Tag</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          git config --local user.email &quot;action@github.com&quot;
          git config --local user.name &quot;GitHub Action&quot;
</span>
          <span class="hljs-string">TAG=&quot;archive-$(date</span> <span class="hljs-string">&#x27;+%Y%m%d-%H%M%S&#x27;</span><span class="hljs-string">)&quot;</span>
          <span class="hljs-string">git</span> <span class="hljs-string">tag</span> <span class="hljs-string">-a</span> <span class="hljs-string">&quot;$TAG&quot;</span> <span class="hljs-string">-m</span> <span class="hljs-string">&quot;Archive: $<span class="hljs-template-variable">{{ github.event.inputs.reason }}</span>&quot;</span>
          <span class="hljs-string">git</span> <span class="hljs-string">push</span> <span class="hljs-string">origin</span> <span class="hljs-string">&quot;$TAG&quot;</span>

          <span class="hljs-string">echo</span> <span class="hljs-string">&quot;ğŸ·ï¸ Archive íƒœê·¸ ìƒì„±: $TAG&quot;</span>
</code></pre>
<h3 id="45-í™˜ê²½ë³„-eb-í™˜ê²½-ìƒì„±-https-ì§€ì›">4.5 í™˜ê²½ë³„ EB í™˜ê²½ ìƒì„± (HTTPS ì§€ì›)</h3>
<pre><code class="language-bash"><span class="hljs-comment"># Development í™˜ê²½ ìƒì„± (ALB í¬í•¨ - HTTPS ì¤€ë¹„)</span>
eb create development \
    --elb-type application \
    --instance_type t3.micro \
    --min-instances 1 \
    --max-instances 1 \
    --envvars NODE_ENV=development,PORT=8080,LOG_LEVEL=debug \
    --service-role aws-elasticbeanstalk-service-role

<span class="hljs-comment"># Production í™˜ê²½ ìƒì„± (ALB í¬í•¨ - ê³ ê°€ìš©ì„± + HTTPS)</span>
eb create production \
    --elb-type application \
    --instance_type t3.medium \
    --min-instances 2 \
    --max-instances 5 \
    --envvars NODE_ENV=production,PORT=8080,LOG_LEVEL=warn \
    --keyname prod-keypair \
    --tags Environment=Production,SSL=Ready \
    --service-role aws-elasticbeanstalk-service-role

<span class="hljs-comment"># ìµœì†Œ ë¹„ìš© ê°œë°œí™˜ê²½ (HTTPS ë¶ˆê°€, ì„œë¹„ìŠ¤ ë¡¤ í•„ìš”)</span>
eb create development-minimal \
    --single \
    --instance_type t3.micro \
    --envvars NODE_ENV=development,PORT=8080 \
    --service-role aws-elasticbeanstalk-service-role
</code></pre>
<p><strong>âš ï¸ í™˜ê²½ ìƒì„± ì‹œ ì£¼ì˜ì‚¬í•­:</strong></p>
<ul>
<li><code>--service-role</code> ì˜µì…˜ì„ ë°˜ë“œì‹œ í¬í•¨í•˜ì—¬ IAM ê¶Œí•œ ë¬¸ì œ ë°©ì§€</li>
<li>Single Instance í™˜ê²½ì—ì„œëŠ” Rolling Update ì„¤ì •ì„ .ebextensionsì—ì„œ ì œê±°í•´ì•¼ í•¨</li>
<li>IAMFullAccess ì •ì±…ì´ ì—†ìœ¼ë©´ ì„œë¹„ìŠ¤ ë¡¤ ìë™ ìƒì„± ì‹¤íŒ¨</li>
</ul>
<hr>
<h2 id="-5ë‹¨ê³„-https-ì„¤ì •-aws-ê³µì‹-ë¬¸ì„œ-ê¸°ë°˜">ğŸ” 5ë‹¨ê³„: HTTPS ì„¤ì • (AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜)</h2>
<h3 id="51-route-53-ë„ë©”ì¸-ë°-acm-ì¸ì¦ì„œ-ì¤€ë¹„">5.1 Route 53 ë„ë©”ì¸ ë° ACM ì¸ì¦ì„œ ì¤€ë¹„</h3>
<h4 id="511-ë„ë©”ì¸-í™•ì¸">5.1.1 ë„ë©”ì¸ í™•ì¸</h4>
<pre><code class="language-bash"><span class="hljs-comment"># Route 53ì—ì„œ êµ¬ë§¤í•œ ë„ë©”ì¸ í™•ì¸</span>
aws route53 list-hosted-zones --query <span class="hljs-string">&#x27;HostedZones[*].{Name:Name,Id:Id}&#x27;</span>
</code></pre>
<h4 id="512-acm-ì¸ì¦ì„œ-ìš”ì²­">5.1.2 ACM ì¸ì¦ì„œ ìš”ì²­</h4>
<pre><code class="language-bash"><span class="hljs-comment"># SSL ì¸ì¦ì„œ ìš”ì²­ (DNS ê²€ì¦ ë°©ì‹)</span>
aws acm request-certificate \
    --domain-name yourdomain.com \
    --subject-alternative-names <span class="hljs-string">&quot;*.yourdomain.com&quot;</span> \
    --validation-method DNS \
    --region ap-northeast-2

<span class="hljs-comment"># ìš”ì²­ëœ ì¸ì¦ì„œ ëª©ë¡ í™•ì¸</span>
aws acm list-certificates --region ap-northeast-2

<span class="hljs-comment"># íŠ¹ì • ì¸ì¦ì„œì˜ DNS ê²€ì¦ ë ˆì½”ë“œ í™•ì¸</span>
aws acm describe-certificate \
    --certificate-arn arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID \
    --region ap-northeast-2
</code></pre>
<h4 id="513-route-53ì—-dns-ê²€ì¦-ë ˆì½”ë“œ-ì¶”ê°€">5.1.3 Route 53ì— DNS ê²€ì¦ ë ˆì½”ë“œ ì¶”ê°€</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ACMì—ì„œ ì œê³µí•œ CNAME ë ˆì½”ë“œë¥¼ Route 53ì— ì¶”ê°€</span>
aws route53 change-resource-record-sets \
    --hosted-zone-id Z1D633PJN98FT9 \
    --change-batch <span class="hljs-string">&#x27;{
        &quot;Changes&quot;: [{
            &quot;Action&quot;: &quot;CREATE&quot;,
            &quot;ResourceRecordSet&quot;: {
                &quot;Name&quot;: &quot;_VALIDATION_RECORD_NAME.yourdomain.com&quot;,
                &quot;Type&quot;: &quot;CNAME&quot;,
                &quot;TTL&quot;: 300,
                &quot;ResourceRecords&quot;: [{&quot;Value&quot;: &quot;VALIDATION_RECORD_VALUE.acm-validations.aws.&quot;}]
            }
        }]
    }&#x27;</span>

<span class="hljs-comment"># ì¸ì¦ì„œ ê²€ì¦ ì™„ë£Œê¹Œì§€ ëŒ€ê¸° (ë³´í†µ 5-10ë¶„)</span>
aws acm <span class="hljs-built_in">wait</span> certificate-validated \
    --certificate-arn arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID \
    --region ap-northeast-2
</code></pre>
<h3 id="52-elastic-beanstalkì—ì„œ-https-ì„¤ì •-aws-ê³µì‹-ë°©ë²•">5.2 Elastic Beanstalkì—ì„œ HTTPS ì„¤ì • (AWS ê³µì‹ ë°©ë²•)</h3>
<h4 id="521-ë°©ë²•-1-ê¸°ë³¸-https-ë¦¬ìŠ¤ë„ˆë§Œ-ì„¤ì •">5.2.1 ë°©ë²• 1: ê¸°ë³¸ HTTPS ë¦¬ìŠ¤ë„ˆë§Œ ì„¤ì •</h4>
<p><strong>.ebextensions/05-https-basic.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-comment">####################################################################################################</span>
<span class="hljs-comment">#### Basic HTTPS Configuration - AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜</span>
<span class="hljs-comment">#### Application Load Balancerì—ì„œë§Œ ë™ì‘ (Classic/Network Load Balancer ì§€ì› ì•ˆí•¨)</span>
<span class="hljs-comment">#### ì½˜ì†”ì—ì„œ ì´ë¯¸ 443 ë¦¬ìŠ¤ë„ˆë¥¼ ë§Œë“¤ì—ˆë‹¤ë©´ ì´ ì„¤ì •ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”</span>
<span class="hljs-comment">####################################################################################################</span>

<span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:elbv2:listener:443:</span>
    <span class="hljs-attr">ListenerEnabled:</span> <span class="hljs-string">&#x27;true&#x27;</span>
    <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTPS</span>
    <span class="hljs-attr">SSLCertificateArns:</span> <span class="hljs-string">arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID</span>
    <span class="hljs-attr">SSLPolicy:</span> <span class="hljs-string">ELBSecurityPolicy-TLS13-1-2-2021-06</span>
</code></pre>
<h4 id="522-ë°©ë²•-2-https--http-ë¦¬ë‹¤ì´ë ‰íŠ¸-ì™„ì „í•œ-ì„¤ì •">5.2.2 ë°©ë²• 2: HTTPS + HTTP ë¦¬ë‹¤ì´ë ‰íŠ¸ (ì™„ì „í•œ ì„¤ì •)</h4>
<p><strong>.ebextensions/05-https-full.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-comment">####################################################################################################</span>
<span class="hljs-comment">#### Complete HTTPS Configuration with HTTP Redirect - AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜</span>
<span class="hljs-comment">#### Application Load Balancerì—ì„œë§Œ ë™ì‘ (Classic/Network Load Balancer ì§€ì› ì•ˆí•¨)</span>
<span class="hljs-comment">#### ì½˜ì†”ì—ì„œ ì´ë¯¸ 443 ë¦¬ìŠ¤ë„ˆë¥¼ ë§Œë“¤ì—ˆë‹¤ë©´ ì´ ì„¤ì •ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”</span>
<span class="hljs-comment">####################################################################################################</span>

<span class="hljs-attr">option_settings:</span>
  <span class="hljs-comment"># HTTPS ë¦¬ìŠ¤ë„ˆ ì„¤ì • (443 í¬íŠ¸)</span>
  <span class="hljs-attr">aws:elbv2:listener:443:</span>
    <span class="hljs-attr">ListenerEnabled:</span> <span class="hljs-string">&#x27;true&#x27;</span>
    <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTPS</span>
    <span class="hljs-attr">SSLCertificateArns:</span> <span class="hljs-string">arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID</span>
    <span class="hljs-attr">SSLPolicy:</span> <span class="hljs-string">ELBSecurityPolicy-TLS13-1-2-2021-06</span>

<span class="hljs-attr">Resources:</span>
  <span class="hljs-comment"># HTTP(80) â†’ HTTPS(443) ë¦¬ë‹¤ì´ë ‰íŠ¸ ì„¤ì •</span>
  <span class="hljs-attr">AWSEBV2LoadBalancerListener:</span>
    <span class="hljs-attr">Type:</span> <span class="hljs-string">&#x27;AWS::ElasticLoadBalancingV2::Listener&#x27;</span>
    <span class="hljs-attr">Properties:</span>
      <span class="hljs-attr">DefaultActions:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">Type:</span> <span class="hljs-string">redirect</span>
          <span class="hljs-attr">RedirectConfig:</span>
            <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTPS</span>
            <span class="hljs-attr">Port:</span> <span class="hljs-string">&#x27;443&#x27;</span>
            <span class="hljs-attr">Host:</span> <span class="hljs-string">&#x27;#{host}&#x27;</span>
            <span class="hljs-attr">Path:</span> <span class="hljs-string">&#x27;/#{path}&#x27;</span>
            <span class="hljs-attr">Query:</span> <span class="hljs-string">&#x27;#{query}&#x27;</span>
            <span class="hljs-attr">StatusCode:</span> <span class="hljs-string">HTTP_301</span>
      <span class="hljs-attr">LoadBalancerArn:</span>
        <span class="hljs-attr">Ref:</span> <span class="hljs-string">AWSEBV2LoadBalancer</span>
      <span class="hljs-attr">Port:</span> <span class="hljs-number">80</span>
      <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTP</span>
</code></pre>
<h4 id="523-ë°©ë²•-3-ë³„ë„-íŒŒì¼ë¡œ-ë¶„ë¦¬-ë‹¨ê³„ë³„-ì ìš©">5.2.3 ë°©ë²• 3: ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬ (ë‹¨ê³„ë³„ ì ìš©)</h4>
<p><strong>Step 1: .ebextensions/05-https-listener.config</strong></p>
<pre><code class="language-yaml"><span class="hljs-comment">####################################################################################################</span>
<span class="hljs-comment">#### HTTPS Listener Only - ë‹¨ê³„ë³„ ì ìš©ìš©</span>
<span class="hljs-comment">#### ë¨¼ì € HTTPS ë¦¬ìŠ¤ë„ˆë§Œ ì„¤ì •í•˜ê³  ë™ì‘ í™•ì¸ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì¶”ê°€</span>
<span class="hljs-comment">####################################################################################################</span>

<span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:elbv2:listener:443:</span>
    <span class="hljs-attr">ListenerEnabled:</span> <span class="hljs-string">&#x27;true&#x27;</span>
    <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTPS</span>
    <span class="hljs-attr">SSLCertificateArns:</span> <span class="hljs-string">arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID</span>
    <span class="hljs-attr">SSLPolicy:</span> <span class="hljs-string">ELBSecurityPolicy-TLS13-1-2-2021-06</span>
</code></pre>
<p><strong>Step 2: .ebextensions/06-https-redirect.config</strong></p>
<pre><code class="language-yaml"><span class="hljs-comment">####################################################################################################</span>
<span class="hljs-comment">#### HTTP to HTTPS Redirect Only - AWS ê³µì‹ ì˜ˆì œ ê¸°ë°˜</span>
<span class="hljs-comment">#### 443 ë¦¬ìŠ¤ë„ˆê°€ ì´ë¯¸ ì¡´ì¬í•´ì•¼ í•¨ (ìœ„ì˜ ì„¤ì • ë˜ëŠ” ì½˜ì†”ì—ì„œ ìƒì„±)</span>
<span class="hljs-comment">####################################################################################################</span>

<span class="hljs-attr">Resources:</span>
  <span class="hljs-attr">AWSEBV2LoadBalancerListener:</span>
    <span class="hljs-attr">Type:</span> <span class="hljs-string">&#x27;AWS::ElasticLoadBalancingV2::Listener&#x27;</span>
    <span class="hljs-attr">Properties:</span>
      <span class="hljs-attr">DefaultActions:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">Type:</span> <span class="hljs-string">redirect</span>
          <span class="hljs-attr">RedirectConfig:</span>
            <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTPS</span>
            <span class="hljs-attr">Port:</span> <span class="hljs-string">&#x27;443&#x27;</span>
            <span class="hljs-attr">Host:</span> <span class="hljs-string">&#x27;#{host}&#x27;</span>
            <span class="hljs-attr">Path:</span> <span class="hljs-string">&#x27;/#{path}&#x27;</span>
            <span class="hljs-attr">Query:</span> <span class="hljs-string">&#x27;#{query}&#x27;</span>
            <span class="hljs-attr">StatusCode:</span> <span class="hljs-string">HTTP_301</span>
      <span class="hljs-attr">LoadBalancerArn:</span>
        <span class="hljs-attr">Ref:</span> <span class="hljs-string">AWSEBV2LoadBalancer</span>
      <span class="hljs-attr">Port:</span> <span class="hljs-number">80</span>
      <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTP</span>
</code></pre>
<h3 id="53-route-53ì—ì„œ-ë„ë©”ì¸-ì—°ê²°">5.3 Route 53ì—ì„œ ë„ë©”ì¸ ì—°ê²°</h3>
<h4 id="531-elastic-beanstalk-alb-dns-ì´ë¦„-í™•ì¸">5.3.1 Elastic Beanstalk ALB DNS ì´ë¦„ í™•ì¸</h4>
<pre><code class="language-bash"><span class="hljs-comment"># EB í™˜ê²½ì˜ ALB DNS ì´ë¦„ í™•ì¸</span>
eb status production | grep CNAME

<span class="hljs-comment"># ë˜ëŠ” AWS CLIë¡œ í™•ì¸</span>
aws elasticbeanstalk describe-environments \
    --environment-names production \
    --query <span class="hljs-string">&#x27;Environments[0].CNAME&#x27;</span>
</code></pre>
<h4 id="532-route-53-a-ë ˆì½”ë“œ-ìƒì„±-alias">5.3.2 Route 53 A ë ˆì½”ë“œ ìƒì„± (Alias)</h4>
<p><strong>âš ï¸ ì¤‘ìš”: ë¦¬ì „ë³„ ALB Hosted Zone ID</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># ë¦¬ì „ë³„ ALB Hosted Zone ID (ì •í™•í•œ ê°’ í•„ìˆ˜!)</span>
<span class="hljs-comment"># ì„œìš¸ (ap-northeast-2): ZWKZPGTI48KDX</span>
<span class="hljs-comment"># ë²„ì§€ë‹ˆì•„ (us-east-1): Z35SXDOTRQ7X7K</span>
<span class="hljs-comment"># ì˜¤í•˜ì´ì˜¤ (us-east-2): Z3AADJGX6KTTL2</span>
<span class="hljs-comment"># ì•„ì¼ëœë“œ (eu-west-1): Z32O12XQLNTSW2</span>
</code></pre>
<pre><code class="language-bash"><span class="hljs-comment"># Route 53ì— A ë ˆì½”ë“œ (Alias) ìƒì„±</span>
aws route53 change-resource-record-sets \
    --hosted-zone-id Z1D633PJN98FT9 \
    --change-batch <span class="hljs-string">&#x27;{
        &quot;Changes&quot;: [
            {
                &quot;Action&quot;: &quot;CREATE&quot;,
                &quot;ResourceRecordSet&quot;: {
                    &quot;Name&quot;: &quot;yourdomain.com&quot;,
                    &quot;Type&quot;: &quot;A&quot;,
                    &quot;AliasTarget&quot;: {
                        &quot;DNSName&quot;: &quot;awseb-AWSEB-XXXXXXXXXXXXXXXX-XXXXXXXXX.ap-northeast-2.elb.amazonaws.com&quot;,
                        &quot;EvaluateTargetHealth&quot;: true,
                        &quot;HostedZoneId&quot;: &quot;ZWKZPGTI48KDX&quot;
                    }
                }
            },
            {
                &quot;Action&quot;: &quot;CREATE&quot;,
                &quot;ResourceRecordSet&quot;: {
                    &quot;Name&quot;: &quot;www.yourdomain.com&quot;,
                    &quot;Type&quot;: &quot;A&quot;,
                    &quot;AliasTarget&quot;: {
                        &quot;DNSName&quot;: &quot;awseb-AWSEB-XXXXXXXXXXXXXXXX-XXXXXXXXX.ap-northeast-2.elb.amazonaws.com&quot;,
                        &quot;EvaluateTargetHealth&quot;: true,
                        &quot;HostedZoneId&quot;: &quot;ZWKZPGTI48KDX&quot;
                    }
                }
            }
        ]
    }&#x27;</span>
</code></pre>
<h3 id="54-ë°°í¬-ë°-í™•ì¸">5.4 ë°°í¬ ë° í™•ì¸</h3>
<h4 id="541-ì„¤ì •-ë°°í¬">5.4.1 ì„¤ì • ë°°í¬</h4>
<pre><code class="language-bash"><span class="hljs-comment"># HTTPS ì„¤ì • ë°°í¬</span>
eb deploy production --<span class="hljs-built_in">timeout</span> 20

<span class="hljs-comment"># ë°°í¬ ìƒíƒœ í™•ì¸</span>
eb status production
eb health production
</code></pre>
<h4 id="542-https-ë™ì‘-í™•ì¸">5.4.2 HTTPS ë™ì‘ í™•ì¸</h4>
<pre><code class="language-bash"><span class="hljs-comment"># HTTP ì ‘ì† ì‹œ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸</span>
curl -I http://yourdomain.com

<span class="hljs-comment"># HTTPS ì ‘ì† í™•ì¸</span>
curl -I https://yourdomain.com

<span class="hljs-comment"># SSL ì¸ì¦ì„œ ì •ë³´ í™•ì¸</span>
openssl s_client -connect yourdomain.com:443 -servername yourdomain.com

<span class="hljs-comment"># ë³´ì•ˆ í—¤ë” í™•ì¸ (ì¶”ê°€ ì„¤ì •í•œ ê²½ìš°)</span>
curl -I https://yourdomain.com | grep -E <span class="hljs-string">&quot;(Strict-Transport|X-Frame|X-Content)&quot;</span>
</code></pre>
<h4 id="543-alb-ë¦¬ìŠ¤ë„ˆ-í™•ì¸">5.4.3 ALB ë¦¬ìŠ¤ë„ˆ í™•ì¸</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ALB ë¦¬ìŠ¤ë„ˆ ëª©ë¡ í™•ì¸</span>
aws elbv2 describe-listeners \
    --load-balancer-arn $(aws elbv2 describe-load-balancers --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].LoadBalancerArn&#x27;</span> --output text)

<span class="hljs-comment"># HTTP ë¦¬ë‹¤ì´ë ‰íŠ¸ ê·œì¹™ í™•ì¸</span>
aws elbv2 describe-rules \
    --listener-arn $(aws elbv2 describe-listeners --load-balancer-arn YOUR-ALB-ARN --query <span class="hljs-string">&#x27;Listeners[?Port==`80`].ListenerArn&#x27;</span> --output text)
</code></pre>
<h3 id="55-ê³ ê¸‰-https-ì„¤ì •-ì„ íƒì‚¬í•­">5.5 ê³ ê¸‰ HTTPS ì„¤ì • (ì„ íƒì‚¬í•­)</h3>
<h4 id="551-ë³´ì•ˆ-í—¤ë”-ì¶”ê°€">5.5.1 ë³´ì•ˆ í—¤ë” ì¶”ê°€</h4>
<p><strong>.ebextensions/07-security-headers.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-comment">####################################################################################################</span>
<span class="hljs-comment">#### Security Headers Configuration</span>
<span class="hljs-comment">#### HSTS, CSP ë“± ë³´ì•ˆ í—¤ë” ì¶”ê°€ (Nginx ê¸°ë°˜ í”Œë«í¼ìš©)</span>
<span class="hljs-comment">####################################################################################################</span>

<span class="hljs-attr">files:</span>
  <span class="hljs-string">&#x27;/etc/nginx/conf.d/security-headers.conf&#x27;</span><span class="hljs-string">:</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-string">&#x27;000644&#x27;</span>
    <span class="hljs-attr">owner:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">group:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">content:</span> <span class="hljs-string">|
      # Security Headers
      add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains; preload&quot; always;
      add_header X-Frame-Options DENY always;
      add_header X-Content-Type-Options nosniff always;
      add_header Referrer-Policy strict-origin-when-cross-origin always;
      add_header X-XSS-Protection &quot;1; mode=block&quot; always;
      add_header Content-Security-Policy &quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;;&quot; always;
</span>
<span class="hljs-attr">container_commands:</span>
  <span class="hljs-attr">01_reload_nginx:</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">&#x27;service nginx reload&#x27;</span>
    <span class="hljs-attr">leader_only:</span> <span class="hljs-literal">true</span>
</code></pre>
<h4 id="552-ë‹¤ì¤‘-ë„ë©”ì¸-ì§€ì›">5.5.2 ë‹¤ì¤‘ ë„ë©”ì¸ ì§€ì›</h4>
<p><strong>.ebextensions/08-multi-domain.config:</strong></p>
<pre><code class="language-yaml"><span class="hljs-comment">####################################################################################################</span>
<span class="hljs-comment">#### Multi-Domain Support</span>
<span class="hljs-comment">#### ì—¬ëŸ¬ ë„ë©”ì¸ì—ì„œ ë™ì¼í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì ‘ê·¼ í—ˆìš©</span>
<span class="hljs-comment">####################################################################################################</span>

<span class="hljs-attr">Resources:</span>
  <span class="hljs-attr">AWSEBV2LoadBalancerListenerRuleAdditional:</span>
    <span class="hljs-attr">Type:</span> <span class="hljs-string">AWS::ElasticLoadBalancingV2::ListenerRule</span>
    <span class="hljs-attr">Properties:</span>
      <span class="hljs-attr">Actions:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">Type:</span> <span class="hljs-string">forward</span>
          <span class="hljs-attr">TargetGroupArn:</span>
            <span class="hljs-attr">Ref:</span> <span class="hljs-string">AWSEBV2LoadBalancerTargetGroup</span>
      <span class="hljs-attr">Conditions:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">Field:</span> <span class="hljs-string">host-header</span>
          <span class="hljs-attr">Values:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">api.yourdomain.com</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">admin.yourdomain.com</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">staging.yourdomain.com</span>
      <span class="hljs-attr">ListenerArn:</span>
        <span class="hljs-attr">Ref:</span> <span class="hljs-string">AWSEBV2LoadBalancerListener443</span>
      <span class="hljs-attr">Priority:</span> <span class="hljs-number">10</span>
</code></pre>
<h3 id="56-https-ì„¤ì •-í™•ì¸-ìŠ¤í¬ë¦½íŠ¸">5.6 HTTPS ì„¤ì • í™•ì¸ ìŠ¤í¬ë¦½íŠ¸</h3>
<p><strong><a href="http://check-https.sh">check-https.sh</a>:</strong></p>
<pre><code class="language-bash"><span class="hljs-meta">#!/bin/bash</span>

DOMAIN=<span class="hljs-string">&quot;yourdomain.com&quot;</span>
GREEN=<span class="hljs-string">&#x27;\033[0;32m&#x27;</span>
RED=<span class="hljs-string">&#x27;\033[0;31m&#x27;</span>
BLUE=<span class="hljs-string">&#x27;\033[0;34m&#x27;</span>
NC=<span class="hljs-string">&#x27;\033[0m&#x27;</span>

<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${BLUE}</span>ğŸ” HTTPS ì„¤ì • í™•ì¸ ì¤‘...<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;==================================&quot;</span>

<span class="hljs-comment"># 1. HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n1. HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸&quot;</span>
HTTP_RESPONSE=$(curl -s -I http://<span class="hljs-variable">$DOMAIN</span> | <span class="hljs-built_in">head</span> -n 1)
<span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$HTTP_RESPONSE</span> == *<span class="hljs-string">&quot;301&quot;</span>* || <span class="hljs-variable">$HTTP_RESPONSE</span> == *<span class="hljs-string">&quot;302&quot;</span>* ]]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>âœ… HTTP ë¦¬ë‹¤ì´ë ‰íŠ¸ ì •ìƒ<span class="hljs-variable">${NC}</span>&quot;</span>
    curl -s -I http://<span class="hljs-variable">$DOMAIN</span> | grep -i <span class="hljs-string">&quot;location:&quot;</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>âŒ HTTP ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹¤íŒ¨<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ì‘ë‹µ: <span class="hljs-variable">$HTTP_RESPONSE</span>&quot;</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># 2. HTTPS ì—°ê²° í™•ì¸</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n2. HTTPS ì—°ê²° í™•ì¸&quot;</span>
<span class="hljs-keyword">if</span> curl -s -I https://<span class="hljs-variable">$DOMAIN</span> &gt; /dev/null 2&gt;&amp;1; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>âœ… HTTPS ì—°ê²° ì •ìƒ<span class="hljs-variable">${NC}</span>&quot;</span>
    curl -s -I https://<span class="hljs-variable">$DOMAIN</span> | <span class="hljs-built_in">head</span> -n 1
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>âŒ HTTPS ì—°ê²° ì‹¤íŒ¨<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># 3. SSL ì¸ì¦ì„œ í™•ì¸</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n3. SSL ì¸ì¦ì„œ í™•ì¸&quot;</span>
CERT_INFO=$(<span class="hljs-built_in">echo</span> | openssl s_client -connect <span class="hljs-variable">$DOMAIN</span>:443 -servername <span class="hljs-variable">$DOMAIN</span> 2&gt;/dev/null | openssl x509 -noout -subject -dates 2&gt;/dev/null)
<span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>âœ… SSL ì¸ì¦ì„œ ì •ìƒ<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$CERT_INFO</span>&quot;</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>âŒ SSL ì¸ì¦ì„œ í™•ì¸ ì‹¤íŒ¨<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># 4. ALB ë¦¬ìŠ¤ë„ˆ í™•ì¸</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n4. ALB ë¦¬ìŠ¤ë„ˆ í™•ì¸&quot;</span>
ALB_ARN=$(aws elbv2 describe-load-balancers --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].LoadBalancerArn&#x27;</span> --output text 2&gt;/dev/null)
<span class="hljs-keyword">if</span> [ ! -z <span class="hljs-string">&quot;<span class="hljs-variable">$ALB_ARN</span>&quot;</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>âœ… ALB ë°œê²¬<span class="hljs-variable">${NC}</span>&quot;</span>
    aws elbv2 describe-listeners --load-balancer-arn <span class="hljs-variable">$ALB_ARN</span> --query <span class="hljs-string">&#x27;Listeners[*].{Port:Port,Protocol:Protocol}&#x27;</span> --output table
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>âŒ ALBë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># 5. ìƒì„¸ SSL í…ŒìŠ¤íŠ¸ ë§í¬</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n5. ìƒì„¸ SSL í…ŒìŠ¤íŠ¸&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸ”— https://www.ssllabs.com/ssltest/analyze.html?d=<span class="hljs-variable">$DOMAIN</span>&quot;</span>

<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\n<span class="hljs-variable">${GREEN}</span>âœ… HTTPS ì„¤ì • í™•ì¸ ì™„ë£Œ!<span class="hljs-variable">${NC}</span>&quot;</span>
</code></pre>
<h3 id="57-í†µí•©-ë°°í¬-ìŠ¤í¬ë¦½íŠ¸-ì—…ë°ì´íŠ¸">5.7 í†µí•© ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì—…ë°ì´íŠ¸</h3>
<p><strong><a href="http://deploy-prod.sh">deploy-prod.sh</a> (HTTPS í™•ì¸ í¬í•¨):</strong></p>
<pre><code class="language-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-built_in">set</span> -e

<span class="hljs-comment"># ìƒ‰ìƒ ì •ì˜</span>
GREEN=<span class="hljs-string">&#x27;\033[0;32m&#x27;</span>
BLUE=<span class="hljs-string">&#x27;\033[0;34m&#x27;</span>
YELLOW=<span class="hljs-string">&#x27;\033[1;33m&#x27;</span>
RED=<span class="hljs-string">&#x27;\033[0;31m&#x27;</span>
NC=<span class="hljs-string">&#x27;\033[0m&#x27;</span>

<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>ğŸ‰ Production í™˜ê²½ ë°°í¬ (rel ë¸Œëœì¹˜)<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;==================================&quot;</span>

<span class="hljs-comment"># Git ë¸Œëœì¹˜ í™•ì¸</span>
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$CURRENT_BRANCH</span>&quot;</span> != <span class="hljs-string">&quot;rel&quot;</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>âŒ í˜„ì¬ ë¸Œëœì¹˜: $CURRENT_BRANCH<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Production ë°°í¬ëŠ” rel ë¸Œëœì¹˜ì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.&quot;</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># ë©”ì‹œì§€ ì„¤ì •</span>
MESSAGE=<span class="hljs-variable">${1:-&quot;Production deployment $(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)&quot;}</span>

<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>ğŸš¨ PRODUCTION í™˜ê²½ì— ë°°í¬í•©ë‹ˆë‹¤! ğŸš¨<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ë©”ì‹œì§€: <span class="hljs-variable">$MESSAGE</span>&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
<span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;ì •ë§ë¡œ í”„ë¡œë•ì…˜ì— ë°°í¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): &quot;</span> -n 1 -r
<span class="hljs-built_in">echo</span>
<span class="hljs-keyword">if</span> [[ ! <span class="hljs-variable">$REPLY</span> =~ ^[Yy]$ ]]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ë°°í¬ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.&quot;</span>
    <span class="hljs-built_in">exit</span> 0
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># ë°°í¬</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${BLUE}</span>ğŸš€ í”„ë¡œë•ì…˜ ë°°í¬ ì‹œì‘...<span class="hljs-variable">${NC}</span>&quot;</span>
eb deploy production --message <span class="hljs-string">&quot;<span class="hljs-variable">$MESSAGE</span>&quot;</span> --<span class="hljs-built_in">timeout</span> 20

<span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>ğŸ‰ Production ë°°í¬ ì™„ë£Œ!<span class="hljs-variable">${NC}</span>&quot;</span>

    <span class="hljs-comment"># HTTPS ì„¤ì • í™•ì¸ ì¶”ê°€</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${BLUE}</span>ğŸ” HTTPS ì„¤ì • í™•ì¸ ì¤‘...<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">&quot;./check-https.sh&quot;</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">chmod</span> +x ./check-https.sh
        ./check-https.sh
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;check-https.sh íŒŒì¼ì´ ì—†ì–´ HTTPS í™•ì¸ì„ ê±´ë„ˆëœë‹ˆë‹¤.&quot;</span>
    <span class="hljs-keyword">fi</span>

    eb health production
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸŒ Production URLs:&quot;</span>
    eb status production | grep CNAME
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸ”’ HTTPS URL: https://yourdomain.com&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>ğŸŠ ëª¨ë“  íŒ€ì›ì—ê²Œ ë°°í¬ ì™„ë£Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”! ğŸŠ<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;âŒ ë°°í¬ ì‹¤íŒ¨&quot;</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
</code></pre>
<hr>
<h2 id="-6ë‹¨ê³„-ë¸Œëœì¹˜-ì „ëµë³„-ë°°í¬-ìŠ¤í¬ë¦½íŠ¸-ì„¤ì •">ğŸ“± 6ë‹¨ê³„: ë¸Œëœì¹˜ ì „ëµë³„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •</h2>
<h3 id="61-í™˜ê²½ë³„-ë°°í¬-ìŠ¤í¬ë¦½íŠ¸">6.1 í™˜ê²½ë³„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸</h3>
<p><strong><a href="http://deploy-dev.sh">deploy-dev.sh</a> (Development í™˜ê²½ìš©):</strong></p>
<pre><code class="language-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-built_in">set</span> -e

<span class="hljs-comment"># ìƒ‰ìƒ ì •ì˜</span>
GREEN=<span class="hljs-string">&#x27;\033[0;32m&#x27;</span>
BLUE=<span class="hljs-string">&#x27;\033[0;34m&#x27;</span>
YELLOW=<span class="hljs-string">&#x27;\033[1;33m&#x27;</span>
NC=<span class="hljs-string">&#x27;\033[0m&#x27;</span>

<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${BLUE}</span>ğŸš€ Development í™˜ê²½ ë°°í¬<span class="hljs-variable">${NC}</span>&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;==================================&quot;</span>

<span class="hljs-comment"># Git ë¸Œëœì¹˜ í™•ì¸</span>
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$CURRENT_BRANCH</span>&quot;</span> != <span class="hljs-string">&quot;dev&quot;</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${YELLOW}</span>âš ï¸ í˜„ì¬ ë¸Œëœì¹˜: $CURRENT_BRANCH<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Development ë°°í¬ëŠ” dev ë¸Œëœì¹˜ì—ì„œ ì§„í–‰í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.&quot;</span>
    <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;ê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): &quot;</span> -n 1 -r
    <span class="hljs-built_in">echo</span>
    <span class="hljs-keyword">if</span> [[ ! <span class="hljs-variable">$REPLY</span> =~ ^[Yy]$ ]]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">exit</span> 0
    <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># ë©”ì‹œì§€ ì„¤ì •</span>
MESSAGE=<span class="hljs-variable">${1:-&quot;Dev deployment $(date &#x27;+%Y-%m-%d %H:%M:%S&#x27;)&quot;}</span>

<span class="hljs-comment"># ë°°í¬</span>
eb deploy development --message <span class="hljs-string">&quot;<span class="hljs-variable">$MESSAGE</span>&quot;</span> --<span class="hljs-built_in">timeout</span> 15

<span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>âœ… Development ë°°í¬ ì™„ë£Œ!<span class="hljs-variable">${NC}</span>&quot;</span>
    eb health development
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸŒ Development URL:&quot;</span>
    eb status development | grep CNAME
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;âŒ ë°°í¬ ì‹¤íŒ¨&quot;</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
</code></pre>
<h3 id="62-makefile-ë¸Œëœì¹˜ë³„-ë°°í¬-ì§€ì›">6.2 Makefile (ë¸Œëœì¹˜ë³„ ë°°í¬ ì§€ì›)</h3>
<pre><code class="language-makefile"><span class="hljs-comment"># Makefile (ë¸Œëœì¹˜ ì „ëµ ì§€ì›)</span>
<span class="hljs-meta"><span class="hljs-keyword">.PHONY</span>: help deploy-dev deploy-prod status-all health-all logs-all</span>

<span class="hljs-comment"># ìƒ‰ìƒ ì •ì˜</span>
BLUE = \033[0;34m
GREEN = \033[0;32m
YELLOW = \033[1;33m
RED = \033[0;31m
NC = \033[0m

<span class="hljs-comment"># í˜„ì¬ ë¸Œëœì¹˜ í™•ì¸</span>
CURRENT_BRANCH := <span class="hljs-variable">$(<span class="hljs-built_in">shell</span> git rev-parse --abbrev-ref HEAD 2&gt;/dev/null || echo &quot;unknown&quot;)</span>

<span class="hljs-comment"># ê¸°ë³¸ ëª…ë ¹ì–´</span>
<span class="hljs-section">all: help</span>

<span class="hljs-section">help:</span>
	@echo <span class="hljs-string">&quot;<span class="hljs-variable">$(BLUE)</span>ğŸš€ ë¸Œëœì¹˜ ì „ëµ ê¸°ë°˜ ë°°í¬ ëª…ë ¹ì–´<span class="hljs-variable">$(NC)</span>&quot;</span>
	@echo <span class="hljs-string">&quot;================================================&quot;</span>
	@echo <span class="hljs-string">&quot;&quot;</span>
	@echo <span class="hljs-string">&quot;í˜„ì¬ ë¸Œëœì¹˜: <span class="hljs-variable">$(YELLOW)</span><span class="hljs-variable">$(CURRENT_BRANCH)</span><span class="hljs-variable">$(NC)</span>&quot;</span>
	@echo <span class="hljs-string">&quot;&quot;</span>
	@echo <span class="hljs-string">&quot;ë°°í¬ ëª…ë ¹ì–´:&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make deploy-dev<span class="hljs-variable">$(NC)</span>      - Development í™˜ê²½ ë°°í¬ (dev ë¸Œëœì¹˜)&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make deploy-prod<span class="hljs-variable">$(NC)</span>     - Production í™˜ê²½ ë°°í¬ (rel ë¸Œëœì¹˜)&quot;</span>
	@echo <span class="hljs-string">&quot;&quot;</span>
	@echo <span class="hljs-string">&quot;HTTPS í™•ì¸:&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make check-https<span class="hljs-variable">$(NC)</span>     - HTTPS ì„¤ì • í™•ì¸&quot;</span>
	@echo <span class="hljs-string">&quot;&quot;</span>
	@echo <span class="hljs-string">&quot;ëª¨ë‹ˆí„°ë§ ëª…ë ¹ì–´:&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make status-all<span class="hljs-variable">$(NC)</span>      - ëª¨ë“  í™˜ê²½ ìƒíƒœ í™•ì¸&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make health-all<span class="hljs-variable">$(NC)</span>      - ëª¨ë“  í™˜ê²½ í—¬ìŠ¤ ì²´í¬&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make logs-dev<span class="hljs-variable">$(NC)</span>        - Development ë¡œê·¸&quot;</span>
	@echo <span class="hljs-string">&quot;  <span class="hljs-variable">$(GREEN)</span>make logs-prod<span class="hljs-variable">$(NC)</span>       - Production ë¡œê·¸&quot;</span>

<span class="hljs-comment"># ë°°í¬ ëª…ë ¹ì–´</span>
<span class="hljs-section">deploy-dev:</span>
	@echo <span class="hljs-string">&quot;<span class="hljs-variable">$(BLUE)</span>ğŸš€ Development í™˜ê²½ ë°°í¬<span class="hljs-variable">$(NC)</span>&quot;</span>
	@./deploy-dev.sh <span class="hljs-string">&quot;<span class="hljs-variable">$(MSG)</span>&quot;</span>

<span class="hljs-section">deploy-prod:</span>
	@echo <span class="hljs-string">&quot;<span class="hljs-variable">$(RED)</span>ğŸ‰ Production í™˜ê²½ ë°°í¬<span class="hljs-variable">$(NC)</span>&quot;</span>
	@./deploy-rel.sh <span class="hljs-string">&quot;<span class="hljs-variable">$(MSG)</span>&quot;</span>

<span class="hljs-comment"># HTTPS í™•ì¸</span>
<span class="hljs-section">check-https:</span>
	@echo <span class="hljs-string">&quot;<span class="hljs-variable">$(BLUE)</span>ğŸ” HTTPS ì„¤ì • í™•ì¸<span class="hljs-variable">$(NC)</span>&quot;</span>
	@./check-https.sh

<span class="hljs-comment"># ìƒíƒœ í™•ì¸</span>
<span class="hljs-section">status-all:</span>
	@echo <span class="hljs-string">&quot;<span class="hljs-variable">$(BLUE)</span>ğŸ“Š ëª¨ë“  í™˜ê²½ ìƒíƒœ í™•ì¸<span class="hljs-variable">$(NC)</span>&quot;</span>
	@eb status development 2&gt;/dev/null || echo <span class="hljs-string">&quot;Development í™˜ê²½ ì—†ìŒ&quot;</span>
	@eb status production 2&gt;/dev/null || echo <span class="hljs-string">&quot;Production í™˜ê²½ ì—†ìŒ&quot;</span>

<span class="hljs-section">health-all:</span>
	@echo <span class="hljs-string">&quot;<span class="hljs-variable">$(BLUE)</span>ğŸ¥ ëª¨ë“  í™˜ê²½ í—¬ìŠ¤ ì²´í¬<span class="hljs-variable">$(NC)</span>&quot;</span>
	@eb health development 2&gt;/dev/null || echo <span class="hljs-string">&quot;Development í™˜ê²½ ì—†ìŒ&quot;</span>
	@eb health production 2&gt;/dev/null || echo <span class="hljs-string">&quot;Production í™˜ê²½ ì—†ìŒ&quot;</span>
</code></pre>
<h3 id="63-ê°œë°œ-ì›Œí¬í”Œë¡œìš°-ìŠ¤í¬ë¦½íŠ¸">6.3 ê°œë°œ ì›Œí¬í”Œë¡œìš° ìŠ¤í¬ë¦½íŠ¸</h3>
<p><strong><a href="http://workflow.sh">workflow.sh</a> (ì „ì²´ ì›Œí¬í”Œë¡œìš° ë„ì›€):</strong></p>
<pre><code class="language-bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># ìƒ‰ìƒ ì •ì˜</span>
GREEN=<span class="hljs-string">&#x27;\033[0;32m&#x27;</span>
BLUE=<span class="hljs-string">&#x27;\033[0;34m&#x27;</span>
YELLOW=<span class="hljs-string">&#x27;\033[1;33m&#x27;</span>
RED=<span class="hljs-string">&#x27;\033[0;31m&#x27;</span>
NC=<span class="hljs-string">&#x27;\033[0m&#x27;</span>

<span class="hljs-function"><span class="hljs-title">show_workflow_help</span></span>() {
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${BLUE}</span>ğŸ”„ ê°œë°œ ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;==================================&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;1ï¸âƒ£  ìƒˆ ê¸°ëŠ¥ ê°œë°œ:&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git checkout dev&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git pull origin dev&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git checkout -b feature/new-feature&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # ê°œë°œ ì‘ì—…...&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git add . &amp;&amp; git commit -m &#x27;feat: ìƒˆ ê¸°ëŠ¥ ì¶”ê°€&#x27;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git push origin feature/new-feature&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # GitHubì—ì„œ feature/new-feature â†’ dev PR ìƒì„±&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;2ï¸âƒ£  ê°œë°œ í™˜ê²½ í…ŒìŠ¤íŠ¸:&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # PR ë¨¸ì§€ í›„ ìë™ìœ¼ë¡œ Development í™˜ê²½ì— ë°°í¬ë¨&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # ë˜ëŠ” ìˆ˜ë™ ë°°í¬:&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git checkout dev&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make deploy-dev&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;3ï¸âƒ£  í”„ë¡œë•ì…˜ ë°°í¬:&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # dev â†’ rel PR ìƒì„± ë° ë¨¸ì§€&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # PR ë¨¸ì§€ í›„ ìë™ìœ¼ë¡œ Production í™˜ê²½ì— ë°°í¬ë¨&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   # ë˜ëŠ” ìˆ˜ë™ ë°°í¬:&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   git checkout rel&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make deploy-prod&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;4ï¸âƒ£  HTTPS í™•ì¸:&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make check-https&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${YELLOW}</span>ğŸ’¡ ìœ ìš©í•œ ëª…ë ¹ì–´:<span class="hljs-variable">${NC}</span>&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make help              # ëª¨ë“  ëª…ë ¹ì–´ ë³´ê¸°&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make status-all        # ëª¨ë“  í™˜ê²½ ìƒíƒœ í™•ì¸&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make health-all        # ëª¨ë“  í™˜ê²½ í—¬ìŠ¤ ì²´í¬&quot;</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;   make check-https       # HTTPS ì„¤ì • í™•ì¸&quot;</span>
}

<span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> <span class="hljs-keyword">in</span>
    <span class="hljs-string">&quot;help&quot;</span>|<span class="hljs-string">&quot;&quot;</span>|<span class="hljs-string">&quot;-h&quot;</span>|<span class="hljs-string">&quot;--help&quot;</span>)
        show_workflow_help
        ;;
    <span class="hljs-string">&quot;feature&quot;</span>)
        FEATURE_NAME=<span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span>
        <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$FEATURE_NAME</span>&quot;</span> ]; <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;ê¸°ëŠ¥ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”: &quot;</span> FEATURE_NAME
        <span class="hljs-keyword">fi</span>
        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${BLUE}</span>ğŸš€ ìƒˆ ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±: feature/$FEATURE_NAME<span class="hljs-variable">${NC}</span>&quot;</span>
        git checkout dev
        git pull origin dev
        git checkout -b <span class="hljs-string">&quot;feature/<span class="hljs-variable">$FEATURE_NAME</span>&quot;</span>
        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${GREEN}</span>âœ… feature/<span class="hljs-variable">$FEATURE_NAME</span> ë¸Œëœì¹˜ì—ì„œ ê°œë°œì„ ì‹œì‘í•˜ì„¸ìš”!<span class="hljs-variable">${NC}</span>&quot;</span>
        ;;
    <span class="hljs-string">&quot;deploy&quot;</span>)
        CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$CURRENT_BRANCH</span>&quot;</span> <span class="hljs-keyword">in</span>
            <span class="hljs-string">&quot;dev&quot;</span>)
                make deploy-dev
                ;;
            <span class="hljs-string">&quot;rel&quot;</span>)
                make deploy-prod
                ;;
            *)
                <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">${RED}</span>âŒ í˜„ì¬ ë¸Œëœì¹˜(<span class="hljs-variable">$CURRENT_BRANCH</span>)ì—ì„œëŠ” ë°°í¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<span class="hljs-variable">${NC}</span>&quot;</span>
                <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;dev(Development), rel(Production) ë¸Œëœì¹˜ì—ì„œë§Œ ë°°í¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.&quot;</span>
                ;;
        <span class="hljs-keyword">esac</span>
        ;;
    <span class="hljs-string">&quot;https&quot;</span>)
        make check-https
        ;;
    *)
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ì‚¬ìš©ë²•: <span class="hljs-variable">$0</span> {help|feature|deploy|https}&quot;</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;  help     - ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ í‘œì‹œ&quot;</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;  feature  - ìƒˆ ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±&quot;</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;  deploy   - í˜„ì¬ ë¸Œëœì¹˜ì— ë§ëŠ” í™˜ê²½ì— ë°°í¬&quot;</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;  https    - HTTPS ì„¤ì • í™•ì¸&quot;</span>
        ;;
<span class="hljs-keyword">esac</span>
</code></pre>
<hr>
<h2 id="-7ë‹¨ê³„-í…ŒìŠ¤íŠ¸-ë°-ê²€ì¦">âœ… 7ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦</h2>
<h3 id="71-ë¡œì»¬-í…ŒìŠ¤íŠ¸">7.1 ë¡œì»¬ í…ŒìŠ¤íŠ¸</h3>
<pre><code class="language-bash"><span class="hljs-comment"># Docker ë¹Œë“œ í…ŒìŠ¤íŠ¸</span>
docker build -t my-app .

<span class="hljs-comment"># ë¡œì»¬ ì‹¤í–‰ í…ŒìŠ¤íŠ¸</span>
docker run -p 3000:8080 my-app

<span class="hljs-comment"># í—¬ìŠ¤ì²´í¬ í…ŒìŠ¤íŠ¸</span>
curl http://localhost:3000/health
</code></pre>
<h3 id="72-ë¸Œëœì¹˜ë³„-ë°°í¬-í…ŒìŠ¤íŠ¸">7.2 ë¸Œëœì¹˜ë³„ ë°°í¬ í…ŒìŠ¤íŠ¸</h3>
<p><strong>Development í™˜ê²½ í…ŒìŠ¤íŠ¸:</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># dev ë¸Œëœì¹˜ì—ì„œ ë°°í¬</span>
git checkout dev
make deploy-dev

<span class="hljs-comment"># ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¡œ</span>
./deploy-dev.sh <span class="hljs-string">&quot;ê°œë°œ í™˜ê²½ í…ŒìŠ¤íŠ¸&quot;</span>

<span class="hljs-comment"># ìƒíƒœ í™•ì¸</span>
eb status development
eb health development
</code></pre>
<p><strong>Production í™˜ê²½ í…ŒìŠ¤íŠ¸:</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># rel ë¸Œëœì¹˜ì—ì„œ ë°°í¬</span>
git checkout rel
make deploy-prod

<span class="hljs-comment"># ìƒíƒœ í™•ì¸</span>
eb status production
eb health production

<span class="hljs-comment"># HTTPS í™•ì¸</span>
make check-https
</code></pre>
<h3 id="73-https-ì„¤ì •-ê²€ì¦">7.3 HTTPS ì„¤ì • ê²€ì¦</h3>
<pre><code class="language-bash"><span class="hljs-comment"># 1. ALB ë¦¬ìŠ¤ë„ˆ í™•ì¸</span>
aws elbv2 describe-listeners \
    --load-balancer-arn $(aws elbv2 describe-load-balancers --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].LoadBalancerArn&#x27;</span> --output text)

<span class="hljs-comment"># 2. HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í…ŒìŠ¤íŠ¸</span>
curl -I http://yourdomain.com

<span class="hljs-comment"># 3. HTTPS ì ‘ì† í…ŒìŠ¤íŠ¸</span>
curl -I https://yourdomain.com

<span class="hljs-comment"># 4. SSL ì¸ì¦ì„œ ì •ë³´ í™•ì¸</span>
openssl s_client -connect yourdomain.com:443 -servername yourdomain.com

<span class="hljs-comment"># 5. í†µí•© í™•ì¸ ìŠ¤í¬ë¦½íŠ¸</span>
./check-https.sh
</code></pre>
<h3 id="74-github-actions-ì›Œí¬í”Œë¡œìš°-í…ŒìŠ¤íŠ¸">7.4 GitHub Actions ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</h3>
<p><strong>Feature â†’ Dev ì›Œí¬í”Œë¡œìš°:</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># 1. ìƒˆ ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±</span>
./workflow.sh feature new-login

<span class="hljs-comment"># 2. ê°œë°œ ì‘ì—… í›„ ì»¤ë°‹</span>
git add .
git commit -m <span class="hljs-string">&quot;feat: ìƒˆë¡œìš´ ë¡œê·¸ì¸ ê¸°ëŠ¥ ì¶”ê°€&quot;</span>
git push origin feature/new-login

<span class="hljs-comment"># 3. GitHubì—ì„œ feature/new-login â†’ dev PR ìƒì„±</span>
<span class="hljs-comment"># 4. PR ë¨¸ì§€ ì‹œ ìë™ìœ¼ë¡œ Development í™˜ê²½ì— ë°°í¬ë¨</span>
</code></pre>
<p><strong>Dev â†’ Rel ì›Œí¬í”Œë¡œìš°:</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># 1. dev â†’ rel PR ìƒì„± (GitHubì—ì„œ)</span>
<span class="hljs-comment"># 2. PR ë¨¸ì§€ ì‹œ ìë™ìœ¼ë¡œ Production í™˜ê²½ì— ë°°í¬ë¨</span>
<span class="hljs-comment"># 3. í”„ë¡œë•ì…˜ í…ŒìŠ¤íŠ¸ ë° HTTPS í™•ì¸</span>
make check-https
</code></pre>
<hr>
<h2 id="-8ë‹¨ê³„-ìµœì¢…-ì„¤ì •-ì™„ë£Œ">ğŸ¯ 8ë‹¨ê³„: ìµœì¢… ì„¤ì • ì™„ë£Œ</h2>
<h3 id="81-ë¸Œëœì¹˜ë³„-í™˜ê²½-ë§¤í•‘">8.1 ë¸Œëœì¹˜ë³„ í™˜ê²½ ë§¤í•‘</h3>
<p><strong>í™˜ê²½ êµ¬ì„±:</strong></p>
<pre><code class="language-yaml"><span class="hljs-string">Branches</span> <span class="hljs-string">â†’</span> <span class="hljs-attr">Environments:</span>
  <span class="hljs-string">feature/*</span> <span class="hljs-string">â†’</span> <span class="hljs-string">ë¡œì»¬</span> <span class="hljs-string">ê°œë°œ</span> <span class="hljs-string">(Docker)</span>
  <span class="hljs-string">dev</span>       <span class="hljs-string">â†’</span> <span class="hljs-string">Development</span> <span class="hljs-string">(EB:</span> <span class="hljs-string">development</span> <span class="hljs-string">+</span> <span class="hljs-string">ALB)</span>
  <span class="hljs-string">rel</span>       <span class="hljs-string">â†’</span> <span class="hljs-string">Production</span> <span class="hljs-string">(EB:</span> <span class="hljs-string">production</span> <span class="hljs-string">+</span> <span class="hljs-string">ALB</span> <span class="hljs-string">+</span> <span class="hljs-string">HTTPS)</span> <span class="hljs-string">â†</span> <span class="hljs-string">ìµœì¢…</span> <span class="hljs-string">ë°°í¬</span>
  <span class="hljs-string">main</span>      <span class="hljs-string">â†’</span> <span class="hljs-string">Archive</span> <span class="hljs-string">(ì•„ì¹´ì´ë¸Œìš©)</span>

<span class="hljs-attr">Deployment Triggers:</span>
  <span class="hljs-string">PR</span> <span class="hljs-string">â†’</span> <span class="hljs-attr">dev:</span> <span class="hljs-string">Development</span> <span class="hljs-string">ìë™</span> <span class="hljs-string">ë°°í¬</span>
  <span class="hljs-string">PR</span> <span class="hljs-string">â†’</span> <span class="hljs-attr">rel:</span> <span class="hljs-string">Production</span> <span class="hljs-string">ìë™</span> <span class="hljs-string">ë°°í¬</span> <span class="hljs-string">+</span> <span class="hljs-string">Release</span> <span class="hljs-string">ìƒì„±</span> <span class="hljs-string">+</span> <span class="hljs-string">HTTPS</span> <span class="hljs-string">(ìµœì¢…)</span>
  <span class="hljs-attr">main:</span> <span class="hljs-string">ì•„ì¹´ì´ë¸Œìš©</span> <span class="hljs-string">(ìˆ˜ë™</span> <span class="hljs-string">ì‹¤í–‰ë§Œ)</span>

<span class="hljs-string">HTTPS</span> <span class="hljs-string">ì§€ì›:</span>
  <span class="hljs-string">ëª¨ë“ </span> <span class="hljs-string">í™˜ê²½ì—</span> <span class="hljs-string">Application</span> <span class="hljs-string">Load</span> <span class="hljs-string">Balancer</span> <span class="hljs-string">í¬í•¨</span>
  <span class="hljs-string">Production</span> <span class="hljs-string">í™˜ê²½ì—</span> <span class="hljs-string">HTTPS</span> <span class="hljs-string">ì™„ì „</span> <span class="hljs-string">ì ìš©</span>
  <span class="hljs-string">SSL</span> <span class="hljs-string">ì¸ì¦ì„œ</span> <span class="hljs-string">ìë™</span> <span class="hljs-string">ê°±ì‹ </span> <span class="hljs-string">(ACM)</span>
</code></pre>
<h3 id="82-í™˜ê²½ë³„-ì„¤ì •-ì°¨ì´ì ">8.2 í™˜ê²½ë³„ ì„¤ì • ì°¨ì´ì </h3>
<p><strong>Development (.ebextensions/dev-specific.config):</strong></p>
<pre><code class="language-yaml"><span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:autoscaling:launchconfiguration:</span>
    <span class="hljs-attr">InstanceType:</span> <span class="hljs-string">t3.micro</span>
  <span class="hljs-attr">aws:elasticbeanstalk:environment:</span>
    <span class="hljs-attr">EnvironmentType:</span> <span class="hljs-string">LoadBalanced</span>
    <span class="hljs-attr">LoadBalancerType:</span> <span class="hljs-string">application</span>
  <span class="hljs-attr">aws:autoscaling:asg:</span>
    <span class="hljs-attr">MinSize:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">MaxSize:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">aws:elasticbeanstalk:application:environment:</span>
    <span class="hljs-attr">NODE_ENV:</span> <span class="hljs-string">development</span>
    <span class="hljs-attr">LOG_LEVEL:</span> <span class="hljs-string">debug</span>
</code></pre>
<p><strong>Production (.ebextensions/prod-specific.config):</strong></p>
<pre><code class="language-yaml"><span class="hljs-attr">option_settings:</span>
  <span class="hljs-attr">aws:autoscaling:launchconfiguration:</span>
    <span class="hljs-attr">InstanceType:</span> <span class="hljs-string">t3.medium</span>
  <span class="hljs-attr">aws:elasticbeanstalk:environment:</span>
    <span class="hljs-attr">EnvironmentType:</span> <span class="hljs-string">LoadBalanced</span>
    <span class="hljs-attr">LoadBalancerType:</span> <span class="hljs-string">application</span>
  <span class="hljs-attr">aws:autoscaling:asg:</span>
    <span class="hljs-attr">MinSize:</span> <span class="hljs-number">2</span>
    <span class="hljs-attr">MaxSize:</span> <span class="hljs-number">5</span>
  <span class="hljs-attr">aws:elasticbeanstalk:application:environment:</span>
    <span class="hljs-attr">NODE_ENV:</span> <span class="hljs-string">production</span>
    <span class="hljs-attr">LOG_LEVEL:</span> <span class="hljs-string">warn</span>
  <span class="hljs-attr">aws:elbv2:listener:443:</span>
    <span class="hljs-attr">ListenerEnabled:</span> <span class="hljs-string">&#x27;true&#x27;</span>
    <span class="hljs-attr">Protocol:</span> <span class="hljs-string">HTTPS</span>
    <span class="hljs-attr">SSLCertificateArns:</span> <span class="hljs-string">arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID</span>
    <span class="hljs-attr">SSLPolicy:</span> <span class="hljs-string">ELBSecurityPolicy-TLS13-1-2-2021-06</span>
</code></pre>
<hr>
<h2 id="-ì™„ë£Œ-ì²´í¬ë¦¬ìŠ¤íŠ¸">ğŸ“‹ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
<h3 id="ê¸°ë³¸-ì„¤ì •">ê¸°ë³¸ ì„¤ì •</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> AWS ê³„ì • ë° IAM ì‚¬ìš©ì ìƒì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>IAMFullAccess ì •ì±… ì¶”ê°€</strong> (ì¤‘ìš”!)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> AWS CLI ë° EB CLI ì„¤ì¹˜</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> í•„ìˆ˜ ì„œë¹„ìŠ¤ ë¡¤ ìƒì„± (ì„ íƒì‚¬í•­)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> NestJS í”„ë¡œì íŠ¸ ìƒì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> Dockerfile ë° .dockerignore ì‘ì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> .ebextensions í´ë” ì„¤ì • (ALB + ì„œë¹„ìŠ¤ ë¡¤ í¬í•¨)</li>
</ul>
<h3 id="ë¸Œëœì¹˜-ë°-í™˜ê²½-ì„¤ì •">ë¸Œëœì¹˜ ë° í™˜ê²½ ì„¤ì •</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> dev, rel, main ë¸Œëœì¹˜ ìƒì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> GitHub ë¸Œëœì¹˜ ë³´í˜¸ ê·œì¹™ ì„¤ì •</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> Development í™˜ê²½ ìƒì„± (ALB í¬í•¨)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> Production í™˜ê²½ ìƒì„± (ALB í¬í•¨)</li>
</ul>
<h3 id="https-ì„¤ì •-aws-ê³µì‹-ë¬¸ì„œ-ê¸°ë°˜">HTTPS ì„¤ì • (AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜)</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> Route 53 ë„ë©”ì¸ í™•ì¸</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> ACM SSL ì¸ì¦ì„œ ìš”ì²­</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> DNS ê²€ì¦ ë ˆì½”ë“œ ì¶”ê°€</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> ì¸ì¦ì„œ ê²€ì¦ ì™„ë£Œ í™•ì¸</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <code>.ebextensions/05-https-*.config</code> íŒŒì¼ ìƒì„± (ì˜¬ë°”ë¥¸ ë°©ë²•)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> HTTPS ë¦¬ìŠ¤ë„ˆ ì„¤ì • (443 í¬íŠ¸)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ ì„¤ì •</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> Route 53 A ë ˆì½”ë“œ (Alias) ìƒì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> ì˜¬ë°”ë¥¸ ALB Hosted Zone ID ì‚¬ìš©</li>
</ul>
<h3 id="cicd-íŒŒì´í”„ë¼ì¸">CI/CD íŒŒì´í”„ë¼ì¸</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> GitHub Secrets ì„¤ì •</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> deploy-dev.yml ì›Œí¬í”Œë¡œìš° ì„¤ì •</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> deploy-rel.yml ì›Œí¬í”Œë¡œìš° ì„¤ì • (Production ë°°í¬ìš©)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> deploy-production.yml ì›Œí¬í”Œë¡œìš° ì„¤ì • (ì•„ì¹´ì´ë¸Œìš©)</li>
</ul>
<h3 id="ë°°í¬-ìŠ¤í¬ë¦½íŠ¸-ë°-ë„êµ¬">ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ë° ë„êµ¬</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <a href="http://deploy-dev.sh">deploy-dev.sh</a> ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <a href="http://deploy-rel.sh">deploy-rel.sh</a> ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (HTTPS í™•ì¸ í¬í•¨)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <a href="http://check-https.sh">check-https.sh</a> ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> Makefile ì„¤ì • (ë¸Œëœì¹˜ë³„ ëª…ë ¹ì–´)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <a href="http://workflow.sh">workflow.sh</a> í—¬í¼ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</li>
</ul>
<h3 id="ìµœì¢…-í™•ì¸">ìµœì¢… í™•ì¸</h3>
<ul class="contains-task-list">
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> ëª¨ë“  í™˜ê²½ ì •ìƒ ë°°í¬ í™•ì¸</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> í—¬ìŠ¤ì²´í¬ ì‘ë‹µ í™•ì¸ (/health)</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> GitHub PR ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ ë™ì‘ í™•ì¸</strong></li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>HTTPS ì ‘ì† ì •ìƒ í™•ì¸</strong></li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> <strong>SSL ì¸ì¦ì„œ ì •ë³´ í™•ì¸</strong></li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> ALB ë¦¬ìŠ¤ë„ˆ ì •ìƒ ë™ì‘ í™•ì¸</li>
<li class="task-list-item enabled"><input class="task-list-item-checkbox"type="checkbox"> ë¸Œëœì¹˜ë³„ ìë™ ë°°í¬ í™•ì¸</li>
</ul>
<hr>
<h2 id="-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-https-ê´€ë ¨-ì¶”ê°€">ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… (HTTPS ê´€ë ¨ ì¶”ê°€)</h2>
<h3 id="https-ê´€ë ¨-ë¬¸ì œ">HTTPS ê´€ë ¨ ë¬¸ì œ</h3>
<h4 id="1-https-ë¦¬ìŠ¤ë„ˆ-ìƒì„±-ì‹¤íŒ¨">1. HTTPS ë¦¬ìŠ¤ë„ˆ ìƒì„± ì‹¤íŒ¨</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ì˜¤ë¥˜: &quot;A listener with port 443 already exists&quot;</span>
<span class="hljs-comment"># í•´ê²°: ì½˜ì†”ì—ì„œ ìƒì„±ëœ ë¦¬ìŠ¤ë„ˆì™€ ì¶©ëŒ</span>

<span class="hljs-comment"># ê¸°ì¡´ ë¦¬ìŠ¤ë„ˆ í™•ì¸</span>
aws elbv2 describe-listeners \
    --load-balancer-arn $(aws elbv2 describe-load-balancers --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].LoadBalancerArn&#x27;</span> --output text)

<span class="hljs-comment"># í•´ê²°ë°©ë²• 1: option_settingsë§Œ ì‚¬ìš© (ë¦¬ìŠ¤ë„ˆê°€ ì´ë¯¸ ìˆëŠ” ê²½ìš°)</span>
<span class="hljs-comment"># .ebextensions/05-https-existing.config</span>
option_settings:
  aws:elbv2:listener:443:
    ListenerEnabled: <span class="hljs-string">&#x27;true&#x27;</span>
    Protocol: HTTPS
    SSLCertificateArns: arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID

<span class="hljs-comment"># í•´ê²°ë°©ë²• 2: ê¸°ì¡´ ë¦¬ìŠ¤ë„ˆ ì‚­ì œ í›„ ì¬ìƒì„±</span>
aws elbv2 delete-listener --listener-arn EXISTING-LISTENER-ARN
</code></pre>
<h4 id="2-ssl-ì¸ì¦ì„œ-ì˜¤ë¥˜">2. SSL ì¸ì¦ì„œ ì˜¤ë¥˜</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ì˜¤ë¥˜: &quot;Certificate not found&quot; ë˜ëŠ” &quot;Invalid certificate ARN&quot;</span>

<span class="hljs-comment"># ì¸ì¦ì„œ ARN ì¬í™•ì¸</span>
aws acm list-certificates --region ap-northeast-2 \
    --query <span class="hljs-string">&#x27;CertificateSummaryList[*].{Domain:DomainName,Arn:CertificateArn,Status:Status}&#x27;</span>

<span class="hljs-comment"># ì¸ì¦ì„œ ìƒíƒœ í™•ì¸ (ISSUED ì—¬ì•¼ í•¨)</span>
aws acm describe-certificate \
    --certificate-arn arn:aws:acm:ap-northeast-2:YOUR-ACCOUNT:certificate/YOUR-CERT-ID

<span class="hljs-comment"># ë‹¤ë¥¸ ë¦¬ì „ì— ì¸ì¦ì„œê°€ ìˆëŠ”ì§€ í™•ì¸</span>
aws acm list-certificates --region us-east-1
</code></pre>
<h4 id="3-http-ë¦¬ë‹¤ì´ë ‰íŠ¸ê°€-ì‘ë™í•˜ì§€-ì•ŠìŒ">3. HTTP ë¦¬ë‹¤ì´ë ‰íŠ¸ê°€ ì‘ë™í•˜ì§€ ì•ŠìŒ</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ì›ì¸: Classic Load Balancer ì‚¬ìš© ì¤‘</span>
<span class="hljs-comment"># í™•ì¸ë°©ë²•</span>
aws elbv2 describe-load-balancers --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].Type&#x27;</span>

<span class="hljs-comment"># í•´ê²°: Application Load Balancerë¡œ í™˜ê²½ ì¬ìƒì„±</span>
eb create production-new \
    --elb-type application \
    --instance_type t3.medium
</code></pre>
<h4 id="4-route-53-ë„ë©”ì¸-ì—°ê²°-ì‹¤íŒ¨">4. Route 53 ë„ë©”ì¸ ì—°ê²° ì‹¤íŒ¨</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ì˜¤ë¥˜: &quot;InvalidChangeBatch&quot; ë˜ëŠ” &quot;Alias target does not exist&quot;</span>

<span class="hljs-comment"># ALB DNS ì´ë¦„ ì •í™•íˆ í™•ì¸</span>
ALB_DNS=$(eb status production | grep CNAME | awk <span class="hljs-string">&#x27;{print $2}&#x27;</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ALB DNS: <span class="hljs-variable">$ALB_DNS</span>&quot;</span>

<span class="hljs-comment"># ì˜¬ë°”ë¥¸ Hosted Zone ID ì‚¬ìš© (ë¦¬ì „ë³„)</span>
<span class="hljs-comment"># ì„œìš¸(ap-northeast-2): ZWKZPGTI48KDX</span>
<span class="hljs-comment"># í™•ì¸ ë°©ë²•:</span>
aws elbv2 describe-load-balancers \
    --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].CanonicalHostedZoneId&#x27;</span>
</code></pre>
<h4 id="5-mixed-content-ì˜¤ë¥˜-httpsì—ì„œ-http-ë¦¬ì†ŒìŠ¤-ë¡œë“œ">5. Mixed Content ì˜¤ë¥˜ (HTTPSì—ì„œ HTTP ë¦¬ì†ŒìŠ¤ ë¡œë“œ)</h4>
<pre><code class="language-bash"><span class="hljs-comment"># í•´ê²°: ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ HTTPS ê°ì§€ ì„¤ì •</span>
<span class="hljs-comment"># src/main.tsì— ì¶”ê°€</span>
app.set(<span class="hljs-string">&#x27;trust proxy&#x27;</span>, 1); // ALB ë’¤ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ

<span class="hljs-comment"># ë˜ëŠ” Express.jsì˜ ê²½ìš°</span>
app.use((req, res, next) =&gt; {
  <span class="hljs-keyword">if</span> (req.header(<span class="hljs-string">&#x27;x-forwarded-proto&#x27;</span>) !== <span class="hljs-string">&#x27;https&#x27;</span>) {
    res.redirect(`https://<span class="hljs-variable">${req.header(&#x27;host&#x27;)}</span><span class="hljs-variable">${req.url}</span>`);
  } <span class="hljs-keyword">else</span> {
    next();
  }
});
</code></pre>
<h3 id="alb-ë°-https-ê´€ë ¨">ALB ë° HTTPS ê´€ë ¨</h3>
<h4 id="1-alb-ìƒì„±-í™•ì¸">1. ALB ìƒì„± í™•ì¸</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ALB ëª©ë¡ í™•ì¸</span>
aws elbv2 describe-load-balancers \
    --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].{Name:LoadBalancerName,DNS:DNSName,State:State,Type:Type}&#x27;</span>

<span class="hljs-comment"># ALB íƒ€ê²Ÿ ê·¸ë£¹ ìƒíƒœ í™•ì¸</span>
aws elbv2 describe-target-health \
    --target-group-arn $(aws elbv2 describe-target-groups --query <span class="hljs-string">&#x27;TargetGroups[0].TargetGroupArn&#x27;</span> --output text)
</code></pre>
<h4 id="2-ssl-policy-ì—…ë°ì´íŠ¸">2. SSL Policy ì—…ë°ì´íŠ¸</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ìµœì‹  SSL ì •ì±…ìœ¼ë¡œ ì—…ë°ì´íŠ¸</span>
<span class="hljs-comment"># .ebextensions/ssl-policy-update.config</span>
option_settings:
  aws:elbv2:listener:443:
    SSLPolicy: ELBSecurityPolicy-TLS13-1-2-2021-06

<span class="hljs-comment"># ë˜ëŠ” CLIë¡œ ì§ì ‘ ì—…ë°ì´íŠ¸</span>
aws elbv2 modify-listener \
    --listener-arn YOUR-LISTENER-ARN \
    --ssl-policy ELBSecurityPolicy-TLS13-1-2-2021-06
</code></pre>
<h4 id="3-https-í—¬ìŠ¤ì²´í¬-ì„¤ì •">3. HTTPS í—¬ìŠ¤ì²´í¬ ì„¤ì •</h4>
<pre><code class="language-bash"><span class="hljs-comment"># HTTPS ì—”ë“œí¬ì¸íŠ¸ë¡œ í—¬ìŠ¤ì²´í¬ ë³€ê²½</span>
<span class="hljs-comment"># .ebextensions/https-health.config</span>
option_settings:
  aws:elasticbeanstalk:environment:process:default:
    Port: 8080
    Protocol: HTTP
    HealthCheckPath: /health
    <span class="hljs-comment"># ALBëŠ” ë°±ì—”ë“œì™€ HTTPë¡œ í†µì‹ í•˜ë¯€ë¡œ Protocolì€ HTTP ìœ ì§€</span>
</code></pre>
<h3 id="ë¸Œëœì¹˜-ì „ëµ-ê´€ë ¨">ë¸Œëœì¹˜ ì „ëµ ê´€ë ¨</h3>
<h4 id="1-pr-ìë™-ë°°í¬ê°€-ì•ˆë˜ëŠ”-ê²½ìš°">1. PR ìë™ ë°°í¬ê°€ ì•ˆë˜ëŠ” ê²½ìš°</h4>
<pre><code class="language-bash"><span class="hljs-comment"># GitHub Actions ì›Œí¬í”Œë¡œìš° íŒŒì¼ í™•ì¸</span>
<span class="hljs-built_in">ls</span> -la .github/workflows/

<span class="hljs-comment"># ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë¡œê·¸ í™•ì¸ (GitHub Actions íƒ­ì—ì„œ)</span>
<span class="hljs-comment"># ì¼ë°˜ì ì¸ ì›ì¸:</span>
<span class="hljs-comment"># - AWS ìê²©ì¦ëª… ì˜¤ë¥˜</span>
<span class="hljs-comment"># - ë¸Œëœì¹˜ ë³´í˜¸ ê·œì¹™ ì¶©ëŒ</span>
<span class="hljs-comment"># - EB í™˜ê²½ ì´ë¦„ ë¶ˆì¼ì¹˜</span>

<span class="hljs-comment"># Secrets ì¬ì„¤ì •</span>
<span class="hljs-comment"># GitHub Repository â†’ Settings â†’ Secrets and variables â†’ Actions</span>
</code></pre>
<h4 id="2-ì˜ëª»ëœ-ë¸Œëœì¹˜ì—ì„œ-ë°°í¬-ì‹œë„">2. ì˜ëª»ëœ ë¸Œëœì¹˜ì—ì„œ ë°°í¬ ì‹œë„</h4>
<pre><code class="language-bash"><span class="hljs-comment"># í˜„ì¬ ë¸Œëœì¹˜ í™•ì¸</span>
git branch --show-current

<span class="hljs-comment"># ì˜¬ë°”ë¥¸ ë¸Œëœì¹˜ë¡œ ì „í™˜</span>
make switch-dev    <span class="hljs-comment"># dev ë¸Œëœì¹˜ë¡œ</span>
make switch-rel    <span class="hljs-comment"># rel ë¸Œëœì¹˜ë¡œ</span>
make switch-main   <span class="hljs-comment"># main ë¸Œëœì¹˜ë¡œ</span>

<span class="hljs-comment"># ë¸Œëœì¹˜ ë³´í˜¸ ì„¤ì •ìœ¼ë¡œ ê°•ì œ ì°¨ë‹¨</span>
</code></pre>
<h4 id="3-í™˜ê²½ë³„-ì„¤ì •-ì°¨ì´ë¡œ-ì¸í•œ-ì˜¤ë¥˜">3. í™˜ê²½ë³„ ì„¤ì • ì°¨ì´ë¡œ ì¸í•œ ì˜¤ë¥˜</h4>
<pre><code class="language-bash"><span class="hljs-comment"># í™˜ê²½ë³„ í™˜ê²½ë³€ìˆ˜ í™•ì¸</span>
eb <span class="hljs-built_in">printenv</span> development
eb <span class="hljs-built_in">printenv</span> production

<span class="hljs-comment"># í™˜ê²½ë³„ ì„¤ì • íŒŒì¼ ë¶„ë¦¬</span>
<span class="hljs-comment"># .ebextensions/dev-specific.config (Developmentìš©)</span>
<span class="hljs-comment"># .ebextensions/prod-specific.config (Productionìš©)</span>
</code></pre>
<h3 id="ì„±ëŠ¥-ë°-ëª¨ë‹ˆí„°ë§">ì„±ëŠ¥ ë° ëª¨ë‹ˆí„°ë§</h3>
<h4 id="1-alb-ì ‘ì†-ë¡œê·¸-í™œì„±í™”">1. ALB ì ‘ì† ë¡œê·¸ í™œì„±í™”</h4>
<pre><code class="language-bash"><span class="hljs-comment"># .ebextensions/alb-logs.config</span>
option_settings:
  aws:elbv2:loadbalancer:
    AccessLogsS3Enabled: <span class="hljs-literal">true</span>
    AccessLogsS3Bucket: my-app-alb-logs
    AccessLogsS3Prefix: production

<span class="hljs-comment"># S3 ë²„í‚· ìƒì„±</span>
aws s3 mb s3://my-app-alb-logs
</code></pre>
<h4 id="2-cloudwatch-ë©”íŠ¸ë¦­-ì„¤ì •">2. CloudWatch ë©”íŠ¸ë¦­ ì„¤ì •</h4>
<pre><code class="language-bash"><span class="hljs-comment"># ALB ë©”íŠ¸ë¦­ í™•ì¸</span>
aws cloudwatch get-metric-statistics \
    --namespace AWS/ApplicationELB \
    --metric-name RequestCount \
    --dimensions Name=LoadBalancer,Value=app/awseb-AWSEB-XXX/XXX \
    --start-time 2024-01-01T00:00:00Z \
    --end-time 2024-01-01T23:59:59Z \
    --period 3600 \
    --statistics Sum
</code></pre>
<hr>
<h2 id="-ì™„ë£Œ">ğŸ‰ ì™„ë£Œ!</h2>
<p>ì´ì œ <strong>AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜ì˜ ì™„ì „í•œ ë¸Œëœì¹˜ ì „ëµ + NestJS + Docker + Elastic Beanstalk + ALB + HTTPS ì§€ì› + CI/CD</strong> í™˜ê²½ì´ êµ¬ì¶•ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
<h3 id="-ì¼ë°˜ì ì¸-ê°œë°œ-ì›Œí¬í”Œë¡œìš°">ğŸš€ ì¼ë°˜ì ì¸ ê°œë°œ ì›Œí¬í”Œë¡œìš°</h3>
<p><strong>1. ìƒˆ ê¸°ëŠ¥ ê°œë°œ:</strong></p>
<pre><code class="language-bash">./workflow.sh feature login-improvement
<span class="hljs-comment"># ê°œë°œ ì‘ì—…...</span>
git add . &amp;&amp; git commit -m <span class="hljs-string">&quot;feat: ë¡œê·¸ì¸ ê°œì„ &quot;</span>
git push origin feature/login-improvement
<span class="hljs-comment"># GitHubì—ì„œ feature â†’ dev PR ìƒì„±</span>
</code></pre>
<p><strong>2. ê°œë°œ í™˜ê²½ í…ŒìŠ¤íŠ¸:</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># PR ë¨¸ì§€ ì‹œ ìë™ ë°°í¬ë¨ (ALB í¬í•¨)</span>
<span class="hljs-comment"># ë˜ëŠ” ìˆ˜ë™: make deploy-dev</span>
</code></pre>
<p><strong>3. í”„ë¡œë•ì…˜ ë°°í¬:</strong></p>
<pre><code class="language-bash"><span class="hljs-comment"># dev â†’ rel PR ìƒì„± ë° ë¨¸ì§€</span>
<span class="hljs-comment"># PR ë¨¸ì§€ ì‹œ ìë™ ë°°í¬ë¨ + Release ìƒì„± + HTTPS í™œì„±í™”</span>
<span class="hljs-comment"># ë˜ëŠ” ìˆ˜ë™: make deploy-prod</span>
</code></pre>
<p><strong>4. HTTPS í™•ì¸:</strong></p>
<pre><code class="language-bash">make check-https
./workflow.sh https
</code></pre>
<h3 id="-ìœ ìš©í•œ-ëª…ë ¹ì–´ë“¤">ğŸ“± ìœ ìš©í•œ ëª…ë ¹ì–´ë“¤</h3>
<pre><code class="language-bash"><span class="hljs-comment"># ì „ì²´ ìƒí™© íŒŒì•…</span>
make <span class="hljs-built_in">help</span>
make status-all
make health-all

<span class="hljs-comment"># HTTPS ê´€ë ¨</span>
make check-https
curl -I https://yourdomain.com

<span class="hljs-comment"># ë¸Œëœì¹˜ë³„ ë°°í¬</span>
make deploy-dev MSG=<span class="hljs-string">&quot;ìƒˆ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸&quot;</span>
make deploy-prod MSG=<span class="hljs-string">&quot;v1.2.0 ë¦´ë¦¬ì¦ˆ&quot;</span>

<span class="hljs-comment"># ì›Œí¬í”Œë¡œìš° ë„ì›€ë§</span>
./workflow.sh <span class="hljs-built_in">help</span>

<span class="hljs-comment"># ALB ë° HTTPS ìƒíƒœ í™•ì¸</span>
aws elbv2 describe-listeners --load-balancer-arn $(aws elbv2 describe-load-balancers --query <span class="hljs-string">&#x27;LoadBalancers[?contains(LoadBalancerName, `awseb`)].LoadBalancerArn&#x27;</span> --output text)
</code></pre>
<h3 id="-https-ì™„ì „-í™œì„±í™”-í™•ì¸">ğŸ”’ HTTPS ì™„ì „ í™œì„±í™” í™•ì¸</h3>
<pre><code class="language-bash"><span class="hljs-comment"># 1. HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸</span>
curl -I http://yourdomain.com
<span class="hljs-comment"># Expected: 301 Moved Permanently, Location: https://yourdomain.com</span>

<span class="hljs-comment"># 2. HTTPS ì ‘ì† í™•ì¸</span>
curl -I https://yourdomain.com
<span class="hljs-comment"># Expected: 200 OK</span>

<span class="hljs-comment"># 3. SSL ë“±ê¸‰ í™•ì¸</span>
<span class="hljs-comment"># https://www.ssllabs.com/ssltest/analyze.html?d=yourdomain.com</span>

<span class="hljs-comment"># 4. í†µí•© í™•ì¸</span>
./check-https.sh
</code></pre>
<h3 id="-í•µì‹¬-ê°œì„ ì‚¬í•­-aws-ê³µì‹-ë¬¸ì„œ-ê¸°ë°˜">ğŸ¯ í•µì‹¬ ê°œì„ ì‚¬í•­ (AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜)</h3>
<p><strong>âœ… ì˜¬ë°”ë¥¸ HTTPS ì„¤ì •:</strong></p>
<ul>
<li>AWS ê³µì‹ ê¶Œì¥ ë°©ë²• ì‚¬ìš©</li>
<li><code>option_settings</code>ì™€ <code>Resources</code> ì˜¬ë°”ë¥¸ ì¡°í•©</li>
<li>Classic LB ëŒ€ì‹  ALB ì „ìš© ì„¤ì •</li>
<li>ìµœì‹  TLS 1.3 ë³´ì•ˆ ì •ì±…</li>
</ul>
<p><strong>âœ… ì™„ì „í•œ ë¸Œëœì¹˜ ì „ëµ:</strong></p>
<ul>
<li>feature â†’ dev â†’ rel í”Œë¡œìš°</li>
<li>ìë™í™”ëœ ë°°í¬ íŒŒì´í”„ë¼ì¸</li>
<li>í™˜ê²½ë³„ ì„¤ì • ë¶„ë¦¬</li>
<li>HTTPS ë°°í¬ í›„ ìë™ ê²€ì¦</li>
</ul>
<p><strong>âœ… ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì„¤ì •:</strong></p>
<ul>
<li>ê³ ê°€ìš©ì„± Production í™˜ê²½</li>
<li>í¬ê´„ì ì¸ ëª¨ë‹ˆí„°ë§</li>
<li>ë³´ì•ˆ í—¤ë” ì„¤ì •</li>
<li>ìë™ SSL ì¸ì¦ì„œ ê°±ì‹ </li>
</ul>
<p>ì™„ë²½í•œ ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ê°œë°œ í™˜ê²½ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸŠ</p>
<p><strong>ì£¼ìš” íŠ¹ì§•:</strong></p>
<ul>
<li>âœ… AWS ê³µì‹ ë¬¸ì„œ ê¸°ë°˜ HTTPS ì„¤ì •</li>
<li>âœ… ëª¨ë“  í™˜ê²½ì— ALB í¬í•¨</li>
<li>âœ… ìë™ HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸</li>
<li>âœ… ë¸Œëœì¹˜ ì „ëµ ê¸°ë°˜ ìë™ ë°°í¬</li>
<li>âœ… ê³ ê°€ìš©ì„± í”„ë¡œë•ì…˜ í™˜ê²½</li>
<li>âœ… ì™„ì „ ìë™í™”ëœ CI/CD íŒŒì´í”„ë¼ì¸</li>
<li>âœ… í¬ê´„ì ì¸ ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ</li>
</ul>

            <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
            
        </body>
        </html>